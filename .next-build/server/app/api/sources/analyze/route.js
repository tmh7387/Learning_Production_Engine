"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/sources/analyze/route";
exports.ids = ["app/api/sources/analyze/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "http2":
/*!************************!*\
  !*** external "http2" ***!
  \************************/
/***/ ((module) => {

module.exports = require("http2");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsources%2Fanalyze%2Froute&page=%2Fapi%2Fsources%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsources%2Fanalyze%2Froute.ts&appDir=K%3A%5CLearning_Production_Engine%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=K%3A%5CLearning_Production_Engine&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsources%2Fanalyze%2Froute&page=%2Fapi%2Fsources%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsources%2Fanalyze%2Froute.ts&appDir=K%3A%5CLearning_Production_Engine%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=K%3A%5CLearning_Production_Engine&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var K_Learning_Production_Engine_src_app_api_sources_analyze_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/sources/analyze/route.ts */ \"(rsc)/./src/app/api/sources/analyze/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/sources/analyze/route\",\n        pathname: \"/api/sources/analyze\",\n        filename: \"route\",\n        bundlePath: \"app/api/sources/analyze/route\"\n    },\n    resolvedPagePath: \"K:\\\\Learning_Production_Engine\\\\src\\\\app\\\\api\\\\sources\\\\analyze\\\\route.ts\",\n    nextConfigOutput,\n    userland: K_Learning_Production_Engine_src_app_api_sources_analyze_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/sources/analyze/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzb3VyY2VzJTJGYW5hbHl6ZSUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGc291cmNlcyUyRmFuYWx5emUlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZzb3VyY2VzJTJGYW5hbHl6ZSUyRnJvdXRlLnRzJmFwcERpcj1LJTNBJTVDTGVhcm5pbmdfUHJvZHVjdGlvbl9FbmdpbmUlNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUslM0ElNUNMZWFybmluZ19Qcm9kdWN0aW9uX0VuZ2luZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDeUI7QUFDdEc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9sZWFybmluZy1wcm9kdWN0aW9uLWVuZ2luZS8/ZjMwMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJLOlxcXFxMZWFybmluZ19Qcm9kdWN0aW9uX0VuZ2luZVxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxzb3VyY2VzXFxcXGFuYWx5emVcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3NvdXJjZXMvYW5hbHl6ZS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3NvdXJjZXMvYW5hbHl6ZVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvc291cmNlcy9hbmFseXplL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiSzpcXFxcTGVhcm5pbmdfUHJvZHVjdGlvbl9FbmdpbmVcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcc291cmNlc1xcXFxhbmFseXplXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9zb3VyY2VzL2FuYWx5emUvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsources%2Fanalyze%2Froute&page=%2Fapi%2Fsources%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsources%2Fanalyze%2Froute.ts&appDir=K%3A%5CLearning_Production_Engine%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=K%3A%5CLearning_Production_Engine&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/sources/analyze/route.ts":
/*!**********************************************!*\
  !*** ./src/app/api/sources/analyze/route.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   maxDuration: () => (/* binding */ maxDuration)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/auth-helpers-nextjs */ \"(rsc)/./node_modules/@supabase/auth-helpers-nextjs/dist/index.js\");\n/* harmony import */ var _supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _services_orchestrator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/services/orchestrator */ \"(rsc)/./src/services/orchestrator.ts\");\n\n\n\n\nconst maxDuration = 300; // 5-minute timeout for processing\nasync function POST(request) {\n    try {\n        // Authenticate user\n        const supabase = (0,_supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_1__.createServerComponentClient)({\n            cookies: next_headers__WEBPACK_IMPORTED_MODULE_2__.cookies\n        });\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        // Get user's organization\n        const { data: orgMembership } = await supabase.from(\"user_organizations\").select(\"organization_id\").eq(\"user_id\", user.id).single();\n        if (!orgMembership) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"No organization found\"\n            }, {\n                status: 400\n            });\n        }\n        // Parse request\n        const body = await request.json();\n        const { sourceUrl, sourceType } = body;\n        if (!sourceUrl || !sourceType) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"sourceUrl and sourceType are required\"\n            }, {\n                status: 400\n            });\n        }\n        if (![\n            \"youtube\",\n            \"pdf\",\n            \"pptx\"\n        ].includes(sourceType)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"sourceType must be youtube, pdf, or pptx\"\n            }, {\n                status: 400\n            });\n        }\n        // Run pipeline\n        const orchestrator = new _services_orchestrator__WEBPACK_IMPORTED_MODULE_3__.PipelineOrchestrator();\n        const result = await orchestrator.processSourceToLesson(sourceUrl, sourceType, orgMembership.organization_id);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            courseId: result.courseId,\n            lesson: result.lesson\n        });\n    } catch (error) {\n        console.error(\"Analysis error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Analysis failed\",\n            details: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9zb3VyY2VzL2FuYWx5emUvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUF3RDtBQUNvQjtBQUNyQztBQUN3QjtBQUV4RCxNQUFNSSxjQUFjLElBQUksQ0FBQyxrQ0FBa0M7QUFFM0QsZUFBZUMsS0FBS0MsT0FBb0I7SUFDM0MsSUFBSTtRQUNBLG9CQUFvQjtRQUNwQixNQUFNQyxXQUFXTiwwRkFBMkJBLENBQUM7WUFBRUMsT0FBT0EsbURBQUFBO1FBQUM7UUFDdkQsTUFBTSxFQUNGTSxNQUFNLEVBQUVDLElBQUksRUFBRSxFQUNqQixHQUFHLE1BQU1GLFNBQVNHLElBQUksQ0FBQ0MsT0FBTztRQUUvQixJQUFJLENBQUNGLE1BQU07WUFDUCxPQUFPVCxxREFBWUEsQ0FBQ1ksSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQWUsR0FBRztnQkFBRUMsUUFBUTtZQUFJO1FBQ3RFO1FBRUEsMEJBQTBCO1FBQzFCLE1BQU0sRUFBRU4sTUFBTU8sYUFBYSxFQUFFLEdBQUcsTUFBTVIsU0FDakNTLElBQUksQ0FBQyxzQkFDTEMsTUFBTSxDQUFDLG1CQUNQQyxFQUFFLENBQUMsV0FBV1QsS0FBS1UsRUFBRSxFQUNyQkMsTUFBTTtRQUVYLElBQUksQ0FBQ0wsZUFBZTtZQUNoQixPQUFPZixxREFBWUEsQ0FBQ1ksSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQXdCLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUMvRTtRQUVBLGdCQUFnQjtRQUNoQixNQUFNTyxPQUFPLE1BQU1mLFFBQVFNLElBQUk7UUFDL0IsTUFBTSxFQUFFVSxTQUFTLEVBQUVDLFVBQVUsRUFBRSxHQUFHRjtRQUVsQyxJQUFJLENBQUNDLGFBQWEsQ0FBQ0MsWUFBWTtZQUMzQixPQUFPdkIscURBQVlBLENBQUNZLElBQUksQ0FDcEI7Z0JBQUVDLE9BQU87WUFBd0MsR0FDakQ7Z0JBQUVDLFFBQVE7WUFBSTtRQUV0QjtRQUVBLElBQUksQ0FBQztZQUFDO1lBQVc7WUFBTztTQUFPLENBQUNVLFFBQVEsQ0FBQ0QsYUFBYTtZQUNsRCxPQUFPdkIscURBQVlBLENBQUNZLElBQUksQ0FDcEI7Z0JBQUVDLE9BQU87WUFBMkMsR0FDcEQ7Z0JBQUVDLFFBQVE7WUFBSTtRQUV0QjtRQUVBLGVBQWU7UUFDZixNQUFNVyxlQUFlLElBQUl0Qix3RUFBb0JBO1FBQzdDLE1BQU11QixTQUFTLE1BQU1ELGFBQWFFLHFCQUFxQixDQUNuREwsV0FDQUMsWUFDQVIsY0FBY2EsZUFBZTtRQUdqQyxPQUFPNUIscURBQVlBLENBQUNZLElBQUksQ0FBQztZQUNyQmlCLFNBQVM7WUFDVEMsVUFBVUosT0FBT0ksUUFBUTtZQUN6QkMsUUFBUUwsT0FBT0ssTUFBTTtRQUN6QjtJQUNKLEVBQUUsT0FBT2xCLE9BQU87UUFDWm1CLFFBQVFuQixLQUFLLENBQUMsbUJBQW1CQTtRQUNqQyxPQUFPYixxREFBWUEsQ0FBQ1ksSUFBSSxDQUNwQjtZQUNJQyxPQUFPO1lBQ1BvQixTQUFTcEIsaUJBQWlCcUIsUUFBUXJCLE1BQU1zQixPQUFPLEdBQUc7UUFDdEQsR0FDQTtZQUFFckIsUUFBUTtRQUFJO0lBRXRCO0FBQ0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9sZWFybmluZy1wcm9kdWN0aW9uLWVuZ2luZS8uL3NyYy9hcHAvYXBpL3NvdXJjZXMvYW5hbHl6ZS9yb3V0ZS50cz84YWE3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XHJcbmltcG9ydCB7IGNyZWF0ZVNlcnZlckNvbXBvbmVudENsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9hdXRoLWhlbHBlcnMtbmV4dGpzJztcclxuaW1wb3J0IHsgY29va2llcyB9IGZyb20gJ25leHQvaGVhZGVycyc7XHJcbmltcG9ydCB7IFBpcGVsaW5lT3JjaGVzdHJhdG9yIH0gZnJvbSAnQC9zZXJ2aWNlcy9vcmNoZXN0cmF0b3InO1xyXG5cclxuZXhwb3J0IGNvbnN0IG1heER1cmF0aW9uID0gMzAwOyAvLyA1LW1pbnV0ZSB0aW1lb3V0IGZvciBwcm9jZXNzaW5nXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICAvLyBBdXRoZW50aWNhdGUgdXNlclxyXG4gICAgICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU2VydmVyQ29tcG9uZW50Q2xpZW50KHsgY29va2llcyB9KTtcclxuICAgICAgICBjb25zdCB7XHJcbiAgICAgICAgICAgIGRhdGE6IHsgdXNlciB9LFxyXG4gICAgICAgIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIoKTtcclxuXHJcbiAgICAgICAgaWYgKCF1c2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gR2V0IHVzZXIncyBvcmdhbml6YXRpb25cclxuICAgICAgICBjb25zdCB7IGRhdGE6IG9yZ01lbWJlcnNoaXAgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgICAgIC5mcm9tKCd1c2VyX29yZ2FuaXphdGlvbnMnKVxyXG4gICAgICAgICAgICAuc2VsZWN0KCdvcmdhbml6YXRpb25faWQnKVxyXG4gICAgICAgICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VyLmlkKVxyXG4gICAgICAgICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgICAgIGlmICghb3JnTWVtYmVyc2hpcCkge1xyXG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ05vIG9yZ2FuaXphdGlvbiBmb3VuZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFBhcnNlIHJlcXVlc3RcclxuICAgICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XHJcbiAgICAgICAgY29uc3QgeyBzb3VyY2VVcmwsIHNvdXJjZVR5cGUgfSA9IGJvZHk7XHJcblxyXG4gICAgICAgIGlmICghc291cmNlVXJsIHx8ICFzb3VyY2VUeXBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICAgICAgICAgIHsgZXJyb3I6ICdzb3VyY2VVcmwgYW5kIHNvdXJjZVR5cGUgYXJlIHJlcXVpcmVkJyB9LFxyXG4gICAgICAgICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIVsneW91dHViZScsICdwZGYnLCAncHB0eCddLmluY2x1ZGVzKHNvdXJjZVR5cGUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICAgICAgICAgIHsgZXJyb3I6ICdzb3VyY2VUeXBlIG11c3QgYmUgeW91dHViZSwgcGRmLCBvciBwcHR4JyB9LFxyXG4gICAgICAgICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBSdW4gcGlwZWxpbmVcclxuICAgICAgICBjb25zdCBvcmNoZXN0cmF0b3IgPSBuZXcgUGlwZWxpbmVPcmNoZXN0cmF0b3IoKTtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBvcmNoZXN0cmF0b3IucHJvY2Vzc1NvdXJjZVRvTGVzc29uKFxyXG4gICAgICAgICAgICBzb3VyY2VVcmwsXHJcbiAgICAgICAgICAgIHNvdXJjZVR5cGUsXHJcbiAgICAgICAgICAgIG9yZ01lbWJlcnNoaXAub3JnYW5pemF0aW9uX2lkXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgY291cnNlSWQ6IHJlc3VsdC5jb3Vyc2VJZCxcclxuICAgICAgICAgICAgbGVzc29uOiByZXN1bHQubGVzc29uLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdBbmFseXNpcyBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0FuYWx5c2lzIGZhaWxlZCcsXHJcbiAgICAgICAgICAgICAgICBkZXRhaWxzOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiY3JlYXRlU2VydmVyQ29tcG9uZW50Q2xpZW50IiwiY29va2llcyIsIlBpcGVsaW5lT3JjaGVzdHJhdG9yIiwibWF4RHVyYXRpb24iLCJQT1NUIiwicmVxdWVzdCIsInN1cGFiYXNlIiwiZGF0YSIsInVzZXIiLCJhdXRoIiwiZ2V0VXNlciIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsIm9yZ01lbWJlcnNoaXAiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJpZCIsInNpbmdsZSIsImJvZHkiLCJzb3VyY2VVcmwiLCJzb3VyY2VUeXBlIiwiaW5jbHVkZXMiLCJvcmNoZXN0cmF0b3IiLCJyZXN1bHQiLCJwcm9jZXNzU291cmNlVG9MZXNzb24iLCJvcmdhbml6YXRpb25faWQiLCJzdWNjZXNzIiwiY291cnNlSWQiLCJsZXNzb24iLCJjb25zb2xlIiwiZGV0YWlscyIsIkVycm9yIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/sources/analyze/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/config.ts":
/*!***************************!*\
  !*** ./src/lib/config.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config)\n/* harmony export */ });\nconst config = {\n    maxVideoDurationMinutes: parseInt(process.env.MAX_VIDEO_DURATION_MINUTES || \"60\", 10),\n    maxFileSizeMB: parseInt(process.env.MAX_FILE_SIZE_MB || \"50\", 10),\n    ai: {\n        analysisModel: \"google/gemini-3.1-pro-preview\",\n        lessonModel: \"anthropic/claude-sonnet-4-6\",\n        maxTokens: 8192\n    },\n    supabase: {\n        storageBucket: \"source-files\"\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2NvbmZpZy50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQU8sTUFBTUEsU0FBUztJQUNsQkMseUJBQXlCQyxTQUFTQyxRQUFRQyxHQUFHLENBQUNDLDBCQUEwQixJQUFJLE1BQU07SUFDbEZDLGVBQWVKLFNBQVNDLFFBQVFDLEdBQUcsQ0FBQ0csZ0JBQWdCLElBQUksTUFBTTtJQUM5REMsSUFBSTtRQUNBQyxlQUFlO1FBQ2ZDLGFBQWE7UUFDYkMsV0FBVztJQUNmO0lBQ0FDLFVBQVU7UUFDTkMsZUFBZTtJQUNuQjtBQUNKLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9sZWFybmluZy1wcm9kdWN0aW9uLWVuZ2luZS8uL3NyYy9saWIvY29uZmlnLnRzP2EzZWYiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICAgIG1heFZpZGVvRHVyYXRpb25NaW51dGVzOiBwYXJzZUludChwcm9jZXNzLmVudi5NQVhfVklERU9fRFVSQVRJT05fTUlOVVRFUyB8fCAnNjAnLCAxMCksXHJcbiAgICBtYXhGaWxlU2l6ZU1COiBwYXJzZUludChwcm9jZXNzLmVudi5NQVhfRklMRV9TSVpFX01CIHx8ICc1MCcsIDEwKSxcclxuICAgIGFpOiB7XHJcbiAgICAgICAgYW5hbHlzaXNNb2RlbDogJ2dvb2dsZS9nZW1pbmktMy4xLXByby1wcmV2aWV3JyxcclxuICAgICAgICBsZXNzb25Nb2RlbDogJ2FudGhyb3BpYy9jbGF1ZGUtc29ubmV0LTQtNicsXHJcbiAgICAgICAgbWF4VG9rZW5zOiA4MTkyLFxyXG4gICAgfSxcclxuICAgIHN1cGFiYXNlOiB7XHJcbiAgICAgICAgc3RvcmFnZUJ1Y2tldDogJ3NvdXJjZS1maWxlcycsXHJcbiAgICB9LFxyXG59O1xyXG4iXSwibmFtZXMiOlsiY29uZmlnIiwibWF4VmlkZW9EdXJhdGlvbk1pbnV0ZXMiLCJwYXJzZUludCIsInByb2Nlc3MiLCJlbnYiLCJNQVhfVklERU9fRFVSQVRJT05fTUlOVVRFUyIsIm1heEZpbGVTaXplTUIiLCJNQVhfRklMRV9TSVpFX01CIiwiYWkiLCJhbmFseXNpc01vZGVsIiwibGVzc29uTW9kZWwiLCJtYXhUb2tlbnMiLCJzdXBhYmFzZSIsInN0b3JhZ2VCdWNrZXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/config.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase/server.ts":
/*!************************************!*\
  !*** ./src/lib/supabase/server.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createServiceClient: () => (/* binding */ createServiceClient)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/index.mjs\");\n\nfunction createServiceClient() {\n    const supabaseUrl = \"https://nhjvunaoqiolrvlweypf.supabase.co\";\n    const serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n    if (!supabaseUrl || !serviceRoleKey) {\n        throw new Error(\"Missing Supabase environment variables\");\n    }\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, serviceRoleKey, {\n        auth: {\n            autoRefreshToken: false,\n            persistSession: false\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlL3NlcnZlci50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFxRDtBQUU5QyxTQUFTQztJQUNaLE1BQU1DLGNBQWNDLDBDQUFvQztJQUN4RCxNQUFNRyxpQkFBaUJILFFBQVFDLEdBQUcsQ0FBQ0cseUJBQXlCO0lBRTVELElBQUksQ0FBQ0wsZUFBZSxDQUFDSSxnQkFBZ0I7UUFDakMsTUFBTSxJQUFJRSxNQUFNO0lBQ3BCO0lBRUEsT0FBT1IsbUVBQVlBLENBQUNFLGFBQWFJLGdCQUFnQjtRQUM3Q0csTUFBTTtZQUNGQyxrQkFBa0I7WUFDbEJDLGdCQUFnQjtRQUNwQjtJQUNKO0FBQ0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9sZWFybmluZy1wcm9kdWN0aW9uLWVuZ2luZS8uL3NyYy9saWIvc3VwYWJhc2Uvc2VydmVyLnRzPzJlOGUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTZXJ2aWNlQ2xpZW50KCkge1xyXG4gICAgY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkw7XHJcbiAgICBjb25zdCBzZXJ2aWNlUm9sZUtleSA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVk7XHJcblxyXG4gICAgaWYgKCFzdXBhYmFzZVVybCB8fCAhc2VydmljZVJvbGVLZXkpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgU3VwYWJhc2UgZW52aXJvbm1lbnQgdmFyaWFibGVzJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGNyZWF0ZUNsaWVudChzdXBhYmFzZVVybCwgc2VydmljZVJvbGVLZXksIHtcclxuICAgICAgICBhdXRoOiB7XHJcbiAgICAgICAgICAgIGF1dG9SZWZyZXNoVG9rZW46IGZhbHNlLFxyXG4gICAgICAgICAgICBwZXJzaXN0U2Vzc2lvbjogZmFsc2UsXHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJjcmVhdGVTZXJ2aWNlQ2xpZW50Iiwic3VwYWJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic2VydmljZVJvbGVLZXkiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiRXJyb3IiLCJhdXRoIiwiYXV0b1JlZnJlc2hUb2tlbiIsInBlcnNpc3RTZXNzaW9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase/server.ts\n");

/***/ }),

/***/ "(rsc)/./src/services/ai/openrouterService.ts":
/*!**********************************************!*\
  !*** ./src/services/ai/openrouterService.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   OpenRouterService: () => (/* binding */ OpenRouterService)\n/* harmony export */ });\n/* harmony import */ var _lib_config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/config */ \"(rsc)/./src/lib/config.ts\");\n\nclass OpenRouterService {\n    constructor(){\n        this.baseUrl = \"https://openrouter.ai/api/v1\";\n        this.apiKey = process.env.OPENROUTER_API_KEY || \"\";\n        if (!this.apiKey) {\n            console.warn(\"[OpenRouterService] OPENROUTER_API_KEY is not set. Requests will fail.\");\n        }\n    }\n    async request(path, body) {\n        if (!this.apiKey) throw new Error(\"OPENROUTER_API_KEY is not set\");\n        const response = await fetch(`${this.baseUrl}${path}`, {\n            method: \"POST\",\n            headers: {\n                \"Authorization\": `Bearer ${this.apiKey}`,\n                \"Content-Type\": \"application/json\",\n                \"HTTP-Origin\": \"http://localhost:3000\",\n                \"X-Title\": \"Learning Production Engine\"\n            },\n            body: JSON.stringify(body)\n        });\n        if (!response.ok) {\n            const error = await response.json();\n            throw new Error(`OpenRouter error: ${JSON.stringify(error)}`);\n        }\n        return response.json();\n    }\n    async analyzeVideo(videoUrl, sourceId, transcriptText) {\n        const startTime = Date.now();\n        const prompt = this.getAnalysisPrompt();\n        const content = [\n            {\n                type: \"text\",\n                text: prompt\n            },\n            {\n                type: \"text\",\n                text: `YouTube Video URL: ${videoUrl}`\n            }\n        ];\n        if (transcriptText) {\n            content.push({\n                type: \"text\",\n                text: `\\n\\nVideo Transcript:\\n${transcriptText}`\n            });\n        }\n        const data = await this.request(\"/chat/completions\", {\n            model: _lib_config__WEBPACK_IMPORTED_MODULE_0__.config.ai.analysisModel,\n            messages: [\n                {\n                    role: \"user\",\n                    content\n                }\n            ],\n            response_format: {\n                type: \"json_object\"\n            }\n        });\n        const analysisData = JSON.parse(data.choices[0].message.content);\n        const processingTime = Date.now() - startTime;\n        return {\n            sourceId,\n            analysisData,\n            processingTime,\n            cost: 0,\n            modelUsed: _lib_config__WEBPACK_IMPORTED_MODULE_0__.config.ai.analysisModel\n        };\n    }\n    async analyzeDocument(fileBuffer, fileName, mimeType, sourceId) {\n        const startTime = Date.now();\n        const prompt = this.getAnalysisPrompt();\n        const base64Data = fileBuffer.toString(\"base64\");\n        const data = await this.request(\"/chat/completions\", {\n            model: _lib_config__WEBPACK_IMPORTED_MODULE_0__.config.ai.analysisModel,\n            messages: [\n                {\n                    role: \"user\",\n                    content: [\n                        {\n                            type: \"text\",\n                            text: prompt\n                        },\n                        {\n                            type: \"file\",\n                            data: {\n                                mime_type: mimeType,\n                                data: base64Data\n                            }\n                        }\n                    ]\n                }\n            ],\n            response_format: {\n                type: \"json_object\"\n            }\n        });\n        const analysisData = JSON.parse(data.choices[0].message.content);\n        const processingTime = Date.now() - startTime;\n        return {\n            sourceId,\n            analysisData,\n            processingTime,\n            cost: 0,\n            modelUsed: _lib_config__WEBPACK_IMPORTED_MODULE_0__.config.ai.analysisModel\n        };\n    }\n    async generateLesson(analysis, sourceTitle) {\n        const prompt = this.getLessonPrompt(sourceTitle, analysis);\n        const data = await this.request(\"/chat/completions\", {\n            model: _lib_config__WEBPACK_IMPORTED_MODULE_0__.config.ai.lessonModel,\n            messages: [\n                {\n                    role: \"user\",\n                    content: prompt\n                }\n            ],\n            max_tokens: _lib_config__WEBPACK_IMPORTED_MODULE_0__.config.ai.maxTokens,\n            response_format: {\n                type: \"json_object\"\n            }\n        });\n        const lesson = JSON.parse(data.choices[0].message.content);\n        return lesson;\n    }\n    getAnalysisPrompt() {\n        return `You are an expert instructional designer analyzing content for lesson plan creation.\r\nAnalyze the following content and provide a structured analysis in JSON format:\r\n\r\n{\r\n  \"summary\": \"Comprehensive summary of the content (2-3 paragraphs)\",\r\n  \"mainTopics\": [\"List of main topics covered\"],\r\n  \"keyConceptsAndDefinitions\": [\r\n    {\"concept\": \"Name\", \"definition\": \"Clear definition\"}\r\n  ],\r\n  \"teachingOpportunities\": [\r\n    {\r\n      \"topic\": \"Topic name\",\r\n      \"suggestedApproach\": \"How to teach this\",\r\n      \"bloomsLevel\": \"One of: remember, understand, apply, analyze, evaluate, create\"\r\n    }\r\n  ],\r\n  \"transcript\": \"Key dialogue and narration if applicable\",\r\n  \"visualElements\": [\"Notable visual elements, diagrams, demonstrations\"],\r\n  \"estimatedDifficultyLevel\": \"beginner/intermediate/advanced\",\r\n  \"prerequisites\": [\"What learners should already know\"],\r\n  \"suggestedDuration\": \"Estimated teaching time for this content\"\r\n}\r\n\r\nFocus on educational value and how this content can be transformed into structured learning activities compliant with IATA training standards. Respond ONLY with valid JSON.`;\n    }\n    getLessonPrompt(sourceTitle, analysis) {\n        return `You are an expert aviation instructional designer specializing in IATA training standards.\r\nGiven the following content analysis, create a comprehensive, IATA-compliant lesson plan.\r\n\r\n## Source Content Analysis\r\nTitle: ${sourceTitle}\r\nSummary: ${analysis.summary}\r\nMain Topics: ${analysis.mainTopics.join(\", \")}\r\nKey Concepts: ${JSON.stringify(analysis.keyConceptsAndDefinitions)}\r\nTeaching Opportunities: ${JSON.stringify(analysis.teachingOpportunities)}\r\nDifficulty: ${analysis.estimatedDifficultyLevel}\r\nPrerequisites: ${analysis.prerequisites.join(\", \")}\r\n\r\n## Requirements\r\n1. Follow IATA Training Standards (AHM Chapter 12 / IGOM Chapter 2)\r\n2. Use Bloom's Taxonomy for learning objectives (remember â†’ create)\r\n3. Each terminal objective must have at least one enabling objective\r\n4. Activities must include instruction method, description, duration, and resources\r\n5. Respond with ONLY valid JSON matching the system structure.`;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmljZXMvYWkvb3BlbnJvdXRlclNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBc0M7QUFJL0IsTUFBTUM7SUFJVEMsYUFBYzthQUZOQyxVQUFVO1FBR2QsSUFBSSxDQUFDQyxNQUFNLEdBQUdDLFFBQVFDLEdBQUcsQ0FBQ0Msa0JBQWtCLElBQUk7UUFDaEQsSUFBSSxDQUFDLElBQUksQ0FBQ0gsTUFBTSxFQUFFO1lBQ2RJLFFBQVFDLElBQUksQ0FBQztRQUNqQjtJQUNKO0lBRUEsTUFBY0MsUUFBUUMsSUFBWSxFQUFFQyxJQUFTLEVBQUU7UUFDM0MsSUFBSSxDQUFDLElBQUksQ0FBQ1IsTUFBTSxFQUFFLE1BQU0sSUFBSVMsTUFBTTtRQUVsQyxNQUFNQyxXQUFXLE1BQU1DLE1BQU0sQ0FBQyxFQUFFLElBQUksQ0FBQ1osT0FBTyxDQUFDLEVBQUVRLEtBQUssQ0FBQyxFQUFFO1lBQ25ESyxRQUFRO1lBQ1JDLFNBQVM7Z0JBQ0wsaUJBQWlCLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQ2IsTUFBTSxDQUFDLENBQUM7Z0JBQ3hDLGdCQUFnQjtnQkFDaEIsZUFBZTtnQkFDZixXQUFXO1lBQ2Y7WUFDQVEsTUFBTU0sS0FBS0MsU0FBUyxDQUFDUDtRQUN6QjtRQUVBLElBQUksQ0FBQ0UsU0FBU00sRUFBRSxFQUFFO1lBQ2QsTUFBTUMsUUFBUSxNQUFNUCxTQUFTUSxJQUFJO1lBQ2pDLE1BQU0sSUFBSVQsTUFBTSxDQUFDLGtCQUFrQixFQUFFSyxLQUFLQyxTQUFTLENBQUNFLE9BQU8sQ0FBQztRQUNoRTtRQUVBLE9BQU9QLFNBQVNRLElBQUk7SUFDeEI7SUFFQSxNQUFNQyxhQUFhQyxRQUFnQixFQUFFQyxRQUFnQixFQUFFQyxjQUF1QixFQUEyQjtRQUNyRyxNQUFNQyxZQUFZQyxLQUFLQyxHQUFHO1FBQzFCLE1BQU1DLFNBQVMsSUFBSSxDQUFDQyxpQkFBaUI7UUFFckMsTUFBTUMsVUFBVTtZQUNaO2dCQUFFQyxNQUFNO2dCQUFRQyxNQUFNSjtZQUFPO1lBQzdCO2dCQUFFRyxNQUFNO2dCQUFRQyxNQUFNLENBQUMsbUJBQW1CLEVBQUVWLFNBQVMsQ0FBQztZQUFDO1NBQzFEO1FBRUQsSUFBSUUsZ0JBQWdCO1lBQ2hCTSxRQUFRRyxJQUFJLENBQUM7Z0JBQUVGLE1BQU07Z0JBQVFDLE1BQU0sQ0FBQyx1QkFBdUIsRUFBRVIsZUFBZSxDQUFDO1lBQUM7UUFDbEY7UUFFQSxNQUFNVSxPQUFPLE1BQU0sSUFBSSxDQUFDMUIsT0FBTyxDQUFDLHFCQUFxQjtZQUNqRDJCLE9BQU9yQywrQ0FBTUEsQ0FBQ3NDLEVBQUUsQ0FBQ0MsYUFBYTtZQUM5QkMsVUFBVTtnQkFBQztvQkFBRUMsTUFBTTtvQkFBUVQ7Z0JBQVE7YUFBRTtZQUNyQ1UsaUJBQWlCO2dCQUFFVCxNQUFNO1lBQWM7UUFDM0M7UUFFQSxNQUFNVSxlQUFvQ3pCLEtBQUswQixLQUFLLENBQUNSLEtBQUtTLE9BQU8sQ0FBQyxFQUFFLENBQUNDLE9BQU8sQ0FBQ2QsT0FBTztRQUNwRixNQUFNZSxpQkFBaUJuQixLQUFLQyxHQUFHLEtBQUtGO1FBRXBDLE9BQU87WUFDSEY7WUFDQWtCO1lBQ0FJO1lBQ0FDLE1BQU07WUFDTkMsV0FBV2pELCtDQUFNQSxDQUFDc0MsRUFBRSxDQUFDQyxhQUFhO1FBQ3RDO0lBQ0o7SUFFQSxNQUFNVyxnQkFBZ0JDLFVBQWtCLEVBQUVDLFFBQWdCLEVBQUVDLFFBQWdCLEVBQUU1QixRQUFnQixFQUEyQjtRQUNySCxNQUFNRSxZQUFZQyxLQUFLQyxHQUFHO1FBQzFCLE1BQU1DLFNBQVMsSUFBSSxDQUFDQyxpQkFBaUI7UUFDckMsTUFBTXVCLGFBQWFILFdBQVdJLFFBQVEsQ0FBQztRQUV2QyxNQUFNbkIsT0FBTyxNQUFNLElBQUksQ0FBQzFCLE9BQU8sQ0FBQyxxQkFBcUI7WUFDakQyQixPQUFPckMsK0NBQU1BLENBQUNzQyxFQUFFLENBQUNDLGFBQWE7WUFDOUJDLFVBQVU7Z0JBQ047b0JBQ0lDLE1BQU07b0JBQ05ULFNBQVM7d0JBQ0w7NEJBQUVDLE1BQU07NEJBQVFDLE1BQU1KO3dCQUFPO3dCQUM3Qjs0QkFDSUcsTUFBTTs0QkFDTkcsTUFBTTtnQ0FDRm9CLFdBQVdIO2dDQUNYakIsTUFBTWtCOzRCQUNWO3dCQUNKO3FCQUNIO2dCQUNMO2FBQ0g7WUFDRFosaUJBQWlCO2dCQUFFVCxNQUFNO1lBQWM7UUFDM0M7UUFFQSxNQUFNVSxlQUFvQ3pCLEtBQUswQixLQUFLLENBQUNSLEtBQUtTLE9BQU8sQ0FBQyxFQUFFLENBQUNDLE9BQU8sQ0FBQ2QsT0FBTztRQUNwRixNQUFNZSxpQkFBaUJuQixLQUFLQyxHQUFHLEtBQUtGO1FBRXBDLE9BQU87WUFDSEY7WUFDQWtCO1lBQ0FJO1lBQ0FDLE1BQU07WUFDTkMsV0FBV2pELCtDQUFNQSxDQUFDc0MsRUFBRSxDQUFDQyxhQUFhO1FBQ3RDO0lBQ0o7SUFFQSxNQUFNa0IsZUFBZUMsUUFBNkIsRUFBRUMsV0FBbUIsRUFBNEI7UUFDL0YsTUFBTTdCLFNBQVMsSUFBSSxDQUFDOEIsZUFBZSxDQUFDRCxhQUFhRDtRQUVqRCxNQUFNdEIsT0FBTyxNQUFNLElBQUksQ0FBQzFCLE9BQU8sQ0FBQyxxQkFBcUI7WUFDakQyQixPQUFPckMsK0NBQU1BLENBQUNzQyxFQUFFLENBQUN1QixXQUFXO1lBQzVCckIsVUFBVTtnQkFBQztvQkFBRUMsTUFBTTtvQkFBUVQsU0FBU0Y7Z0JBQU87YUFBRTtZQUM3Q2dDLFlBQVk5RCwrQ0FBTUEsQ0FBQ3NDLEVBQUUsQ0FBQ3lCLFNBQVM7WUFDL0JyQixpQkFBaUI7Z0JBQUVULE1BQU07WUFBYztRQUMzQztRQUVBLE1BQU0rQixTQUEwQjlDLEtBQUswQixLQUFLLENBQUNSLEtBQUtTLE9BQU8sQ0FBQyxFQUFFLENBQUNDLE9BQU8sQ0FBQ2QsT0FBTztRQUMxRSxPQUFPZ0M7SUFDWDtJQUVRakMsb0JBQTRCO1FBQ2hDLE9BQU8sQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7NEtBdUI0SixDQUFDO0lBQ3pLO0lBRVE2QixnQkFBZ0JELFdBQW1CLEVBQUVELFFBQTZCLEVBQVU7UUFDaEYsT0FBTyxDQUFDOzs7O09BSVQsRUFBRUMsWUFBWTtTQUNaLEVBQUVELFNBQVNPLE9BQU8sQ0FBQzthQUNmLEVBQUVQLFNBQVNRLFVBQVUsQ0FBQ0MsSUFBSSxDQUFDLE1BQU07Y0FDaEMsRUFBRWpELEtBQUtDLFNBQVMsQ0FBQ3VDLFNBQVNVLHlCQUF5QixFQUFFO3dCQUMzQyxFQUFFbEQsS0FBS0MsU0FBUyxDQUFDdUMsU0FBU1cscUJBQXFCLEVBQUU7WUFDN0QsRUFBRVgsU0FBU1ksd0JBQXdCLENBQUM7ZUFDakMsRUFBRVosU0FBU2EsYUFBYSxDQUFDSixJQUFJLENBQUMsTUFBTTs7Ozs7Ozs4REFPVyxDQUFDO0lBQzNEO0FBQ0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9sZWFybmluZy1wcm9kdWN0aW9uLWVuZ2luZS8uL3NyYy9zZXJ2aWNlcy9haS9vcGVucm91dGVyU2VydmljZS50cz83MDVjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNvbmZpZyB9IGZyb20gJ0AvbGliL2NvbmZpZyc7XHJcbmltcG9ydCB7IEdlbWluaVZpZGVvQW5hbHlzaXMsIFNvdXJjZUFuYWx5c2lzIH0gZnJvbSAnQC90eXBlcy9hbmFseXNpcyc7XHJcbmltcG9ydCB7IEdlbmVyYXRlZExlc3NvbiB9IGZyb20gJ0AvdHlwZXMvbGVzc29ucyc7XHJcblxyXG5leHBvcnQgY2xhc3MgT3BlblJvdXRlclNlcnZpY2Uge1xyXG4gICAgcHJpdmF0ZSBhcGlLZXk6IHN0cmluZztcclxuICAgIHByaXZhdGUgYmFzZVVybCA9ICdodHRwczovL29wZW5yb3V0ZXIuYWkvYXBpL3YxJztcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLmFwaUtleSA9IHByb2Nlc3MuZW52Lk9QRU5ST1VURVJfQVBJX0tFWSB8fCAnJztcclxuICAgICAgICBpZiAoIXRoaXMuYXBpS2V5KSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignW09wZW5Sb3V0ZXJTZXJ2aWNlXSBPUEVOUk9VVEVSX0FQSV9LRVkgaXMgbm90IHNldC4gUmVxdWVzdHMgd2lsbCBmYWlsLicpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFzeW5jIHJlcXVlc3QocGF0aDogc3RyaW5nLCBib2R5OiBhbnkpIHtcclxuICAgICAgICBpZiAoIXRoaXMuYXBpS2V5KSB0aHJvdyBuZXcgRXJyb3IoJ09QRU5ST1VURVJfQVBJX0tFWSBpcyBub3Qgc2V0Jyk7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5iYXNlVXJsfSR7cGF0aH1gLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmFwaUtleX1gLFxyXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICAgICAgICdIVFRQLU9yaWdpbic6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnLFxyXG4gICAgICAgICAgICAgICAgJ1gtVGl0bGUnOiAnTGVhcm5pbmcgUHJvZHVjdGlvbiBFbmdpbmUnLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShib2R5KSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBPcGVuUm91dGVyIGVycm9yOiAke0pTT04uc3RyaW5naWZ5KGVycm9yKX1gKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgYW5hbHl6ZVZpZGVvKHZpZGVvVXJsOiBzdHJpbmcsIHNvdXJjZUlkOiBzdHJpbmcsIHRyYW5zY3JpcHRUZXh0Pzogc3RyaW5nKTogUHJvbWlzZTxTb3VyY2VBbmFseXNpcz4ge1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5nZXRBbmFseXNpc1Byb21wdCgpO1xyXG5cclxuICAgICAgICBjb25zdCBjb250ZW50ID0gW1xyXG4gICAgICAgICAgICB7IHR5cGU6ICd0ZXh0JywgdGV4dDogcHJvbXB0IH0sXHJcbiAgICAgICAgICAgIHsgdHlwZTogJ3RleHQnLCB0ZXh0OiBgWW91VHViZSBWaWRlbyBVUkw6ICR7dmlkZW9Vcmx9YCB9LFxyXG4gICAgICAgIF07XHJcblxyXG4gICAgICAgIGlmICh0cmFuc2NyaXB0VGV4dCkge1xyXG4gICAgICAgICAgICBjb250ZW50LnB1c2goeyB0eXBlOiAndGV4dCcsIHRleHQ6IGBcXG5cXG5WaWRlbyBUcmFuc2NyaXB0OlxcbiR7dHJhbnNjcmlwdFRleHR9YCB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlcXVlc3QoJy9jaGF0L2NvbXBsZXRpb25zJywge1xyXG4gICAgICAgICAgICBtb2RlbDogY29uZmlnLmFpLmFuYWx5c2lzTW9kZWwsXHJcbiAgICAgICAgICAgIG1lc3NhZ2VzOiBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQgfV0sXHJcbiAgICAgICAgICAgIHJlc3BvbnNlX2Zvcm1hdDogeyB0eXBlOiAnanNvbl9vYmplY3QnIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgYW5hbHlzaXNEYXRhOiBHZW1pbmlWaWRlb0FuYWx5c2lzID0gSlNPTi5wYXJzZShkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50KTtcclxuICAgICAgICBjb25zdCBwcm9jZXNzaW5nVGltZSA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHNvdXJjZUlkLFxyXG4gICAgICAgICAgICBhbmFseXNpc0RhdGEsXHJcbiAgICAgICAgICAgIHByb2Nlc3NpbmdUaW1lLFxyXG4gICAgICAgICAgICBjb3N0OiAwLCAvLyBPcGVuUm91dGVyIGhhbmRsZXMgYmlsbGluZ1xyXG4gICAgICAgICAgICBtb2RlbFVzZWQ6IGNvbmZpZy5haS5hbmFseXNpc01vZGVsLFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgYW5hbHl6ZURvY3VtZW50KGZpbGVCdWZmZXI6IEJ1ZmZlciwgZmlsZU5hbWU6IHN0cmluZywgbWltZVR5cGU6IHN0cmluZywgc291cmNlSWQ6IHN0cmluZyk6IFByb21pc2U8U291cmNlQW5hbHlzaXM+IHtcclxuICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuZ2V0QW5hbHlzaXNQcm9tcHQoKTtcclxuICAgICAgICBjb25zdCBiYXNlNjREYXRhID0gZmlsZUJ1ZmZlci50b1N0cmluZygnYmFzZTY0Jyk7XHJcblxyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlcXVlc3QoJy9jaGF0L2NvbXBsZXRpb25zJywge1xyXG4gICAgICAgICAgICBtb2RlbDogY29uZmlnLmFpLmFuYWx5c2lzTW9kZWwsXHJcbiAgICAgICAgICAgIG1lc3NhZ2VzOiBbXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcm9sZTogJ3VzZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyB0eXBlOiAndGV4dCcsIHRleHQ6IHByb21wdCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZmlsZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWltZV90eXBlOiBtaW1lVHlwZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBiYXNlNjREYXRhXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIHJlc3BvbnNlX2Zvcm1hdDogeyB0eXBlOiAnanNvbl9vYmplY3QnIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgYW5hbHlzaXNEYXRhOiBHZW1pbmlWaWRlb0FuYWx5c2lzID0gSlNPTi5wYXJzZShkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50KTtcclxuICAgICAgICBjb25zdCBwcm9jZXNzaW5nVGltZSA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHNvdXJjZUlkLFxyXG4gICAgICAgICAgICBhbmFseXNpc0RhdGEsXHJcbiAgICAgICAgICAgIHByb2Nlc3NpbmdUaW1lLFxyXG4gICAgICAgICAgICBjb3N0OiAwLFxyXG4gICAgICAgICAgICBtb2RlbFVzZWQ6IGNvbmZpZy5haS5hbmFseXNpc01vZGVsLFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgZ2VuZXJhdGVMZXNzb24oYW5hbHlzaXM6IEdlbWluaVZpZGVvQW5hbHlzaXMsIHNvdXJjZVRpdGxlOiBzdHJpbmcpOiBQcm9taXNlPEdlbmVyYXRlZExlc3Nvbj4ge1xyXG4gICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuZ2V0TGVzc29uUHJvbXB0KHNvdXJjZVRpdGxlLCBhbmFseXNpcyk7XHJcblxyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlcXVlc3QoJy9jaGF0L2NvbXBsZXRpb25zJywge1xyXG4gICAgICAgICAgICBtb2RlbDogY29uZmlnLmFpLmxlc3Nvbk1vZGVsLFxyXG4gICAgICAgICAgICBtZXNzYWdlczogW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV0sXHJcbiAgICAgICAgICAgIG1heF90b2tlbnM6IGNvbmZpZy5haS5tYXhUb2tlbnMsXHJcbiAgICAgICAgICAgIHJlc3BvbnNlX2Zvcm1hdDogeyB0eXBlOiAnanNvbl9vYmplY3QnIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgbGVzc29uOiBHZW5lcmF0ZWRMZXNzb24gPSBKU09OLnBhcnNlKGRhdGEuY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQpO1xyXG4gICAgICAgIHJldHVybiBsZXNzb247XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRBbmFseXNpc1Byb21wdCgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBgWW91IGFyZSBhbiBleHBlcnQgaW5zdHJ1Y3Rpb25hbCBkZXNpZ25lciBhbmFseXppbmcgY29udGVudCBmb3IgbGVzc29uIHBsYW4gY3JlYXRpb24uXHJcbkFuYWx5emUgdGhlIGZvbGxvd2luZyBjb250ZW50IGFuZCBwcm92aWRlIGEgc3RydWN0dXJlZCBhbmFseXNpcyBpbiBKU09OIGZvcm1hdDpcclxuXHJcbntcclxuICBcInN1bW1hcnlcIjogXCJDb21wcmVoZW5zaXZlIHN1bW1hcnkgb2YgdGhlIGNvbnRlbnQgKDItMyBwYXJhZ3JhcGhzKVwiLFxyXG4gIFwibWFpblRvcGljc1wiOiBbXCJMaXN0IG9mIG1haW4gdG9waWNzIGNvdmVyZWRcIl0sXHJcbiAgXCJrZXlDb25jZXB0c0FuZERlZmluaXRpb25zXCI6IFtcclxuICAgIHtcImNvbmNlcHRcIjogXCJOYW1lXCIsIFwiZGVmaW5pdGlvblwiOiBcIkNsZWFyIGRlZmluaXRpb25cIn1cclxuICBdLFxyXG4gIFwidGVhY2hpbmdPcHBvcnR1bml0aWVzXCI6IFtcclxuICAgIHtcclxuICAgICAgXCJ0b3BpY1wiOiBcIlRvcGljIG5hbWVcIixcclxuICAgICAgXCJzdWdnZXN0ZWRBcHByb2FjaFwiOiBcIkhvdyB0byB0ZWFjaCB0aGlzXCIsXHJcbiAgICAgIFwiYmxvb21zTGV2ZWxcIjogXCJPbmUgb2Y6IHJlbWVtYmVyLCB1bmRlcnN0YW5kLCBhcHBseSwgYW5hbHl6ZSwgZXZhbHVhdGUsIGNyZWF0ZVwiXHJcbiAgICB9XHJcbiAgXSxcclxuICBcInRyYW5zY3JpcHRcIjogXCJLZXkgZGlhbG9ndWUgYW5kIG5hcnJhdGlvbiBpZiBhcHBsaWNhYmxlXCIsXHJcbiAgXCJ2aXN1YWxFbGVtZW50c1wiOiBbXCJOb3RhYmxlIHZpc3VhbCBlbGVtZW50cywgZGlhZ3JhbXMsIGRlbW9uc3RyYXRpb25zXCJdLFxyXG4gIFwiZXN0aW1hdGVkRGlmZmljdWx0eUxldmVsXCI6IFwiYmVnaW5uZXIvaW50ZXJtZWRpYXRlL2FkdmFuY2VkXCIsXHJcbiAgXCJwcmVyZXF1aXNpdGVzXCI6IFtcIldoYXQgbGVhcm5lcnMgc2hvdWxkIGFscmVhZHkga25vd1wiXSxcclxuICBcInN1Z2dlc3RlZER1cmF0aW9uXCI6IFwiRXN0aW1hdGVkIHRlYWNoaW5nIHRpbWUgZm9yIHRoaXMgY29udGVudFwiXHJcbn1cclxuXHJcbkZvY3VzIG9uIGVkdWNhdGlvbmFsIHZhbHVlIGFuZCBob3cgdGhpcyBjb250ZW50IGNhbiBiZSB0cmFuc2Zvcm1lZCBpbnRvIHN0cnVjdHVyZWQgbGVhcm5pbmcgYWN0aXZpdGllcyBjb21wbGlhbnQgd2l0aCBJQVRBIHRyYWluaW5nIHN0YW5kYXJkcy4gUmVzcG9uZCBPTkxZIHdpdGggdmFsaWQgSlNPTi5gO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0TGVzc29uUHJvbXB0KHNvdXJjZVRpdGxlOiBzdHJpbmcsIGFuYWx5c2lzOiBHZW1pbmlWaWRlb0FuYWx5c2lzKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gYFlvdSBhcmUgYW4gZXhwZXJ0IGF2aWF0aW9uIGluc3RydWN0aW9uYWwgZGVzaWduZXIgc3BlY2lhbGl6aW5nIGluIElBVEEgdHJhaW5pbmcgc3RhbmRhcmRzLlxyXG5HaXZlbiB0aGUgZm9sbG93aW5nIGNvbnRlbnQgYW5hbHlzaXMsIGNyZWF0ZSBhIGNvbXByZWhlbnNpdmUsIElBVEEtY29tcGxpYW50IGxlc3NvbiBwbGFuLlxyXG5cclxuIyMgU291cmNlIENvbnRlbnQgQW5hbHlzaXNcclxuVGl0bGU6ICR7c291cmNlVGl0bGV9XHJcblN1bW1hcnk6ICR7YW5hbHlzaXMuc3VtbWFyeX1cclxuTWFpbiBUb3BpY3M6ICR7YW5hbHlzaXMubWFpblRvcGljcy5qb2luKCcsICcpfVxyXG5LZXkgQ29uY2VwdHM6ICR7SlNPTi5zdHJpbmdpZnkoYW5hbHlzaXMua2V5Q29uY2VwdHNBbmREZWZpbml0aW9ucyl9XHJcblRlYWNoaW5nIE9wcG9ydHVuaXRpZXM6ICR7SlNPTi5zdHJpbmdpZnkoYW5hbHlzaXMudGVhY2hpbmdPcHBvcnR1bml0aWVzKX1cclxuRGlmZmljdWx0eTogJHthbmFseXNpcy5lc3RpbWF0ZWREaWZmaWN1bHR5TGV2ZWx9XHJcblByZXJlcXVpc2l0ZXM6ICR7YW5hbHlzaXMucHJlcmVxdWlzaXRlcy5qb2luKCcsICcpfVxyXG5cclxuIyMgUmVxdWlyZW1lbnRzXHJcbjEuIEZvbGxvdyBJQVRBIFRyYWluaW5nIFN0YW5kYXJkcyAoQUhNIENoYXB0ZXIgMTIgLyBJR09NIENoYXB0ZXIgMilcclxuMi4gVXNlIEJsb29tJ3MgVGF4b25vbXkgZm9yIGxlYXJuaW5nIG9iamVjdGl2ZXMgKHJlbWVtYmVyIOKGkiBjcmVhdGUpXHJcbjMuIEVhY2ggdGVybWluYWwgb2JqZWN0aXZlIG11c3QgaGF2ZSBhdCBsZWFzdCBvbmUgZW5hYmxpbmcgb2JqZWN0aXZlXHJcbjQuIEFjdGl2aXRpZXMgbXVzdCBpbmNsdWRlIGluc3RydWN0aW9uIG1ldGhvZCwgZGVzY3JpcHRpb24sIGR1cmF0aW9uLCBhbmQgcmVzb3VyY2VzXHJcbjUuIFJlc3BvbmQgd2l0aCBPTkxZIHZhbGlkIEpTT04gbWF0Y2hpbmcgdGhlIHN5c3RlbSBzdHJ1Y3R1cmUuYDtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOlsiY29uZmlnIiwiT3BlblJvdXRlclNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImJhc2VVcmwiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiT1BFTlJPVVRFUl9BUElfS0VZIiwiY29uc29sZSIsIndhcm4iLCJyZXF1ZXN0IiwicGF0aCIsImJvZHkiLCJFcnJvciIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiSlNPTiIsInN0cmluZ2lmeSIsIm9rIiwiZXJyb3IiLCJqc29uIiwiYW5hbHl6ZVZpZGVvIiwidmlkZW9VcmwiLCJzb3VyY2VJZCIsInRyYW5zY3JpcHRUZXh0Iiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsInByb21wdCIsImdldEFuYWx5c2lzUHJvbXB0IiwiY29udGVudCIsInR5cGUiLCJ0ZXh0IiwicHVzaCIsImRhdGEiLCJtb2RlbCIsImFpIiwiYW5hbHlzaXNNb2RlbCIsIm1lc3NhZ2VzIiwicm9sZSIsInJlc3BvbnNlX2Zvcm1hdCIsImFuYWx5c2lzRGF0YSIsInBhcnNlIiwiY2hvaWNlcyIsIm1lc3NhZ2UiLCJwcm9jZXNzaW5nVGltZSIsImNvc3QiLCJtb2RlbFVzZWQiLCJhbmFseXplRG9jdW1lbnQiLCJmaWxlQnVmZmVyIiwiZmlsZU5hbWUiLCJtaW1lVHlwZSIsImJhc2U2NERhdGEiLCJ0b1N0cmluZyIsIm1pbWVfdHlwZSIsImdlbmVyYXRlTGVzc29uIiwiYW5hbHlzaXMiLCJzb3VyY2VUaXRsZSIsImdldExlc3NvblByb21wdCIsImxlc3Nvbk1vZGVsIiwibWF4X3Rva2VucyIsIm1heFRva2VucyIsImxlc3NvbiIsInN1bW1hcnkiLCJtYWluVG9waWNzIiwiam9pbiIsImtleUNvbmNlcHRzQW5kRGVmaW5pdGlvbnMiLCJ0ZWFjaGluZ09wcG9ydHVuaXRpZXMiLCJlc3RpbWF0ZWREaWZmaWN1bHR5TGV2ZWwiLCJwcmVyZXF1aXNpdGVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/services/ai/openrouterService.ts\n");

/***/ }),

/***/ "(rsc)/./src/services/notebooklm/notebookService.ts":
/*!****************************************************!*\
  !*** ./src/services/notebooklm/notebookService.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NotebookLMService: () => (/* binding */ NotebookLMService)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./src/lib/supabase/server.ts\");\n/**\r\n * NotebookLM Integration Service\r\n *\r\n * Creates NotebookLM notebooks populated with course source materials\r\n * and generated analyses/lesson plans for deeper AI-powered exploration.\r\n *\r\n * Note: This service is designed to be called from server-side code only\r\n * (API routes / services). The actual NotebookLM MCP calls are made via\r\n * a REST API wrapper â€” in development, the MCP tools handle this directly.\r\n */ \nclass NotebookLMService {\n    constructor(){\n        this.supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createServiceClient)();\n    }\n    /**\r\n     * Create a NotebookLM notebook for a course, populated with:\r\n     * - Source URL (for YouTube sources)\r\n     * - Analysis text (pasted as text source)\r\n     * - Generated lesson plan summary (pasted as text source)\r\n     */ async createNotebookForCourse(course, analysis, sourceUrl, sourceType) {\n        try {\n            // Build the notebook content from analysis data\n            const notebookTitle = `LEP: ${course.title}`;\n            let sourcesAdded = 0;\n            // Format analysis as readable text\n            const analysisText = this.formatAnalysisAsText(analysis, course.title);\n            // Format lesson plan summary\n            const lessonSummary = await this.getLessonPlanSummary(course.id);\n            // Store the notebook metadata in Supabase\n            // The actual NotebookLM notebook creation happens via the MCP tools\n            // which are called from the API route handler\n            const notebookId = `pending_${course.id}_${Date.now()}`;\n            // Save metadata for later MCP-based creation\n            const { error } = await this.supabase.from(\"courses\").update({\n                notebook_id: notebookId\n            }).eq(\"id\", course.id);\n            if (error) {\n                console.error(\"Failed to store notebook ID:\", error.message);\n                return null;\n            }\n            // Count sources that will be added\n            if (sourceUrl && sourceType === \"youtube\") sourcesAdded++;\n            if (analysisText) sourcesAdded++;\n            if (lessonSummary) sourcesAdded++;\n            console.log(`[NotebookLM] Prepared notebook for course \"${course.title}\" with ${sourcesAdded} sources`);\n            return {\n                notebookId,\n                title: notebookTitle,\n                sourcesAdded\n            };\n        } catch (error) {\n            console.error(\"[NotebookLM] Failed to create notebook:\", error);\n            return null;\n        }\n    }\n    /**\r\n     * Actually create the notebook in NotebookLM via API.\r\n     * This is called from the API route where MCP tools are available.\r\n     */ async getNotebookContent(courseId) {\n        try {\n            // Get course info\n            const { data: course } = await this.supabase.from(\"courses\").select(\"id, title, description\").eq(\"id\", courseId).single();\n            if (!course) return null;\n            // Get linked source info\n            const { data: mappings } = await this.supabase.from(\"lesson_source_mappings\").select(\"source_id\").eq(\"module_id\", courseId);\n            // Get source details via modules\n            const { data: modules } = await this.supabase.from(\"modules\").select(\"id\").eq(\"course_id\", courseId);\n            let sourceUrl;\n            let sourceType;\n            if (modules && modules.length > 0) {\n                const { data: mapping } = await this.supabase.from(\"lesson_source_mappings\").select(\"source_id\").eq(\"module_id\", modules[0].id).single();\n                if (mapping) {\n                    const { data: source } = await this.supabase.from(\"sources\").select(\"source_url, source_type\").eq(\"id\", mapping.source_id).single();\n                    if (source) {\n                        sourceUrl = source.source_url;\n                        sourceType = source.source_type;\n                    }\n                }\n            }\n            // Get analysis data\n            let analysisText = \"\";\n            if (modules && modules.length > 0) {\n                const { data: mapping } = await this.supabase.from(\"lesson_source_mappings\").select(\"source_id\").eq(\"module_id\", modules[0].id).single();\n                if (mapping) {\n                    const { data: analysisData } = await this.supabase.from(\"source_analyses\").select(\"analysis_data\").eq(\"source_id\", mapping.source_id).single();\n                    if (analysisData) {\n                        analysisText = JSON.stringify(analysisData.analysis_data, null, 2);\n                    }\n                }\n            }\n            // Get lesson plan text\n            const lessonPlanText = await this.getLessonPlanSummary(courseId);\n            return {\n                title: `LEP: ${course.title}`,\n                analysisText,\n                lessonPlanText: lessonPlanText || \"\",\n                sourceUrl,\n                sourceType\n            };\n        } catch (error) {\n            console.error(\"[NotebookLM] Failed to get notebook content:\", error);\n            return null;\n        }\n    }\n    /**\r\n     * Format analysis data as human-readable text for NotebookLM ingestion.\r\n     */ formatAnalysisAsText(analysis, courseTitle) {\n        const sections = [\n            `# Source Analysis: ${courseTitle}`,\n            `Model: ${analysis.modelUsed || \"Gemini 1.5 Pro\"}`,\n            \"\"\n        ];\n        const data = analysis.analysisData;\n        if (typeof data === \"object\" && data !== null) {\n            for (const [key, value] of Object.entries(data)){\n                sections.push(`## ${key}`);\n                if (typeof value === \"string\") {\n                    sections.push(value);\n                } else {\n                    sections.push(JSON.stringify(value, null, 2));\n                }\n                sections.push(\"\");\n            }\n        }\n        return sections.join(\"\\n\");\n    }\n    /**\r\n     * Build a text summary of the lesson plan for NotebookLM.\r\n     */ async getLessonPlanSummary(courseId) {\n        try {\n            const { data: modules } = await this.supabase.from(\"modules\").select(\"id, title, module_number, description, duration\").eq(\"course_id\", courseId).order(\"module_number\");\n            if (!modules || modules.length === 0) return null;\n            const sections = [\n                \"# Generated Lesson Plan\\n\"\n            ];\n            for (const mod of modules){\n                sections.push(`## Module ${mod.module_number}: ${mod.title}`);\n                if (mod.description) sections.push(mod.description);\n                if (mod.duration) sections.push(`Duration: ${mod.duration} minutes`);\n                sections.push(\"\");\n                const { data: objectives } = await this.supabase.from(\"learning_objectives\").select(\"id, objective_type, content, blooms_level, order_index\").eq(\"module_id\", mod.id).order(\"order_index\");\n                if (objectives) {\n                    for (const obj of objectives){\n                        sections.push(`### ${obj.objective_type}: ${obj.content}`);\n                        sections.push(`Bloom's Level: ${obj.blooms_level}`);\n                        const { data: activities } = await this.supabase.from(\"learning_activities\").select(\"instruction_method, description, duration\").eq(\"learning_objective_id\", obj.id).order(\"order_index\");\n                        if (activities) {\n                            for (const act of activities){\n                                sections.push(`- **${act.instruction_method}** (${act.duration} min): ${act.description}`);\n                            }\n                        }\n                        sections.push(\"\");\n                    }\n                }\n            }\n            return sections.join(\"\\n\");\n        } catch (error) {\n            console.error(\"[NotebookLM] Failed to build lesson summary:\", error);\n            return null;\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmljZXMvbm90ZWJvb2tsbS9ub3RlYm9va1NlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTs7Ozs7Ozs7O0NBU0MsR0FFMkQ7QUFtQnJELE1BQU1DO0lBR1RDLGFBQWM7UUFDVixJQUFJLENBQUNDLFFBQVEsR0FBR0gseUVBQW1CQTtJQUN2QztJQUVBOzs7OztLQUtDLEdBQ0QsTUFBTUksd0JBQ0ZDLE1BQWtCLEVBQ2xCQyxRQUFzQixFQUN0QkMsU0FBa0IsRUFDbEJDLFVBQXVDLEVBQ0Q7UUFDdEMsSUFBSTtZQUNBLGdEQUFnRDtZQUNoRCxNQUFNQyxnQkFBZ0IsQ0FBQyxLQUFLLEVBQUVKLE9BQU9LLEtBQUssQ0FBQyxDQUFDO1lBQzVDLElBQUlDLGVBQWU7WUFFbkIsbUNBQW1DO1lBQ25DLE1BQU1DLGVBQWUsSUFBSSxDQUFDQyxvQkFBb0IsQ0FBQ1AsVUFBVUQsT0FBT0ssS0FBSztZQUVyRSw2QkFBNkI7WUFDN0IsTUFBTUksZ0JBQWdCLE1BQU0sSUFBSSxDQUFDQyxvQkFBb0IsQ0FBQ1YsT0FBT1csRUFBRTtZQUUvRCwwQ0FBMEM7WUFDMUMsb0VBQW9FO1lBQ3BFLDhDQUE4QztZQUM5QyxNQUFNQyxhQUFhLENBQUMsUUFBUSxFQUFFWixPQUFPVyxFQUFFLENBQUMsQ0FBQyxFQUFFRSxLQUFLQyxHQUFHLEdBQUcsQ0FBQztZQUV2RCw2Q0FBNkM7WUFDN0MsTUFBTSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNLElBQUksQ0FBQ2pCLFFBQVEsQ0FDaENrQixJQUFJLENBQUMsV0FDTEMsTUFBTSxDQUFDO2dCQUFFQyxhQUFhTjtZQUFXLEdBQ2pDTyxFQUFFLENBQUMsTUFBTW5CLE9BQU9XLEVBQUU7WUFFdkIsSUFBSUksT0FBTztnQkFDUEssUUFBUUwsS0FBSyxDQUFDLGdDQUFnQ0EsTUFBTU0sT0FBTztnQkFDM0QsT0FBTztZQUNYO1lBRUEsbUNBQW1DO1lBQ25DLElBQUluQixhQUFhQyxlQUFlLFdBQVdHO1lBQzNDLElB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SUFBSVAsUUFBUSxDQUFDLE9BQU8sRUFBRU8sSUFBSVIsV0FBVyxDQUFDLENBQUM7NEJBQzdGO3dCQUNKO3dCQUNBWCxTQUFTTSxJQUFJLENBQUM7b0JBQ2xCO2dCQUNKO1lBQ0o7WUFFQSxPQUFPTixTQUFTTyxJQUFJLENBQUM7UUFDekIsRUFBRSxPQUFPbEMsT0FBTztZQUNaSyxRQUFRTCxLQUFLLENBQUMsZ0RBQWdEQTtZQUM5RCxPQUFPO1FBQ1g7SUFDSjtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbGVhcm5pbmctcHJvZHVjdGlvbi1lbmdpbmUvLi9zcmMvc2VydmljZXMvbm90ZWJvb2tsbS9ub3RlYm9va1NlcnZpY2UudHM/ZDA3YSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogTm90ZWJvb2tMTSBJbnRlZ3JhdGlvbiBTZXJ2aWNlXHJcbiAqXHJcbiAqIENyZWF0ZXMgTm90ZWJvb2tMTSBub3RlYm9va3MgcG9wdWxhdGVkIHdpdGggY291cnNlIHNvdXJjZSBtYXRlcmlhbHNcclxuICogYW5kIGdlbmVyYXRlZCBhbmFseXNlcy9sZXNzb24gcGxhbnMgZm9yIGRlZXBlciBBSS1wb3dlcmVkIGV4cGxvcmF0aW9uLlxyXG4gKlxyXG4gKiBOb3RlOiBUaGlzIHNlcnZpY2UgaXMgZGVzaWduZWQgdG8gYmUgY2FsbGVkIGZyb20gc2VydmVyLXNpZGUgY29kZSBvbmx5XHJcbiAqIChBUEkgcm91dGVzIC8gc2VydmljZXMpLiBUaGUgYWN0dWFsIE5vdGVib29rTE0gTUNQIGNhbGxzIGFyZSBtYWRlIHZpYVxyXG4gKiBhIFJFU1QgQVBJIHdyYXBwZXIg4oCUIGluIGRldmVsb3BtZW50LCB0aGUgTUNQIHRvb2xzIGhhbmRsZSB0aGlzIGRpcmVjdGx5LlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IGNyZWF0ZVNlcnZpY2VDbGllbnQgfSBmcm9tICdAL2xpYi9zdXBhYmFzZS9zZXJ2ZXInO1xyXG5cclxuaW50ZXJmYWNlIE5vdGVib29rQ3JlYXRpb25SZXN1bHQge1xyXG4gICAgbm90ZWJvb2tJZDogc3RyaW5nO1xyXG4gICAgdGl0bGU6IHN0cmluZztcclxuICAgIHNvdXJjZXNBZGRlZDogbnVtYmVyO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgQ291cnNlRGF0YSB7XHJcbiAgICBpZDogc3RyaW5nO1xyXG4gICAgdGl0bGU6IHN0cmluZztcclxuICAgIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgQW5hbHlzaXNEYXRhIHtcclxuICAgIGFuYWx5c2lzRGF0YTogUmVjb3JkPHN0cmluZywgdW5rbm93bj47XHJcbiAgICBtb2RlbFVzZWQ/OiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBOb3RlYm9va0xNU2VydmljZSB7XHJcbiAgICBwcml2YXRlIHN1cGFiYXNlO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuc3VwYWJhc2UgPSBjcmVhdGVTZXJ2aWNlQ2xpZW50KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGUgYSBOb3RlYm9va0xNIG5vdGVib29rIGZvciBhIGNvdXJzZSwgcG9wdWxhdGVkIHdpdGg6XHJcbiAgICAgKiAtIFNvdXJjZSBVUkwgKGZvciBZb3VUdWJlIHNvdXJjZXMpXHJcbiAgICAgKiAtIEFuYWx5c2lzIHRleHQgKHBhc3RlZCBhcyB0ZXh0IHNvdXJjZSlcclxuICAgICAqIC0gR2VuZXJhdGVkIGxlc3NvbiBwbGFuIHN1bW1hcnkgKHBhc3RlZCBhcyB0ZXh0IHNvdXJjZSlcclxuICAgICAqL1xyXG4gICAgYXN5bmMgY3JlYXRlTm90ZWJvb2tGb3JDb3Vyc2UoXHJcbiAgICAgICAgY291cnNlOiBDb3Vyc2VEYXRhLFxyXG4gICAgICAgIGFuYWx5c2lzOiBBbmFseXNpc0RhdGEsXHJcbiAgICAgICAgc291cmNlVXJsPzogc3RyaW5nLFxyXG4gICAgICAgIHNvdXJjZVR5cGU/OiAneW91dHViZScgfCAncGRmJyB8ICdwcHR4J1xyXG4gICAgKTogUHJvbWlzZTxOb3RlYm9va0NyZWF0aW9uUmVzdWx0IHwgbnVsbD4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIEJ1aWxkIHRoZSBub3RlYm9vayBjb250ZW50IGZyb20gYW5hbHlzaXMgZGF0YVxyXG4gICAgICAgICAgICBjb25zdCBub3RlYm9va1RpdGxlID0gYExFUDogJHtjb3Vyc2UudGl0bGV9YDtcclxuICAgICAgICAgICAgbGV0IHNvdXJjZXNBZGRlZCA9IDA7XHJcblxyXG4gICAgICAgICAgICAvLyBGb3JtYXQgYW5hbHlzaXMgYXMgcmVhZGFibGUgdGV4dFxyXG4gICAgICAgICAgICBjb25zdCBhbmFseXNpc1RleHQgPSB0aGlzLmZvcm1hdEFuYWx5c2lzQXNUZXh0KGFuYWx5c2lzLCBjb3Vyc2UudGl0bGUpO1xyXG5cclxuICAgICAgICAgICAgLy8gRm9ybWF0IGxlc3NvbiBwbGFuIHN1bW1hcnlcclxuICAgICAgICAgICAgY29uc3QgbGVzc29uU3VtbWFyeSA9IGF3YWl0IHRoaXMuZ2V0TGVzc29uUGxhblN1bW1hcnkoY291cnNlLmlkKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFN0b3JlIHRoZSBub3RlYm9vayBtZXRhZGF0YSBpbiBTdXBhYmFzZVxyXG4gICAgICAgICAgICAvLyBUaGUgYWN0dWFsIE5vdGVib29rTE0gbm90ZWJvb2sgY3JlYXRpb24gaGFwcGVucyB2aWEgdGhlIE1DUCB0b29sc1xyXG4gICAgICAgICAgICAvLyB3aGljaCBhcmUgY2FsbGVkIGZyb20gdGhlIEFQSSByb3V0ZSBoYW5kbGVyXHJcbiAgICAgICAgICAgIGNvbnN0IG5vdGVib29rSWQgPSBgcGVuZGluZ18ke2NvdXJzZS5pZH1fJHtEYXRlLm5vdygpfWA7XHJcblxyXG4gICAgICAgICAgICAvLyBTYXZlIG1ldGFkYXRhIGZvciBsYXRlciBNQ1AtYmFzZWQgY3JlYXRpb25cclxuICAgICAgICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgICAgICAgICAgLmZyb20oJ2NvdXJzZXMnKVxyXG4gICAgICAgICAgICAgICAgLnVwZGF0ZSh7IG5vdGVib29rX2lkOiBub3RlYm9va0lkIH0pXHJcbiAgICAgICAgICAgICAgICAuZXEoJ2lkJywgY291cnNlLmlkKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHN0b3JlIG5vdGVib29rIElEOicsIGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIENvdW50IHNvdXJjZXMgdGhhdCB3aWxsIGJlIGFkZGVkXHJcbiAgICAgICAgICAgIGlmIChzb3VyY2VVcmwgJiYgc291cmNlVHlwZSA9PT0gJ3lvdXR1YmUnKSBzb3VyY2VzQWRkZWQrKztcclxuICAgICAgICAgICAgaWYgKGFuYWx5c2lzVGV4dCkgc291cmNlc0FkZGVkKys7XHJcbiAgICAgICAgICAgIGlmIChsZXNzb25TdW1tYXJ5KSBzb3VyY2VzQWRkZWQrKztcclxuXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbTm90ZWJvb2tMTV0gUHJlcGFyZWQgbm90ZWJvb2sgZm9yIGNvdXJzZSBcIiR7Y291cnNlLnRpdGxlfVwiIHdpdGggJHtzb3VyY2VzQWRkZWR9IHNvdXJjZXNgKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBub3RlYm9va0lkLFxyXG4gICAgICAgICAgICAgICAgdGl0bGU6IG5vdGVib29rVGl0bGUsXHJcbiAgICAgICAgICAgICAgICBzb3VyY2VzQWRkZWQsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignW05vdGVib29rTE1dIEZhaWxlZCB0byBjcmVhdGUgbm90ZWJvb2s6JywgZXJyb3IpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBY3R1YWxseSBjcmVhdGUgdGhlIG5vdGVib29rIGluIE5vdGVib29rTE0gdmlhIEFQSS5cclxuICAgICAqIFRoaXMgaXMgY2FsbGVkIGZyb20gdGhlIEFQSSByb3V0ZSB3aGVyZSBNQ1AgdG9vbHMgYXJlIGF2YWlsYWJsZS5cclxuICAgICAqL1xyXG4gICAgYXN5bmMgZ2V0Tm90ZWJvb2tDb250ZW50KGNvdXJzZUlkOiBzdHJpbmcpOiBQcm9taXNlPHtcclxuICAgICAgICB0aXRsZTogc3RyaW5nO1xyXG4gICAgICAgIGFuYWx5c2lzVGV4dDogc3RyaW5nO1xyXG4gICAgICAgIGxlc3NvblBsYW5UZXh0OiBzdHJpbmc7XHJcbiAgICAgICAgc291cmNlVXJsPzogc3RyaW5nO1xyXG4gICAgICAgIHNvdXJjZVR5cGU/OiBzdHJpbmc7XHJcbiAgICB9IHwgbnVsbD4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIEdldCBjb3Vyc2UgaW5mb1xyXG4gICAgICAgICAgICBjb25zdCB7IGRhdGE6IGNvdXJzZSB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgICAgICAgICAgLmZyb20oJ2NvdXJzZXMnKVxyXG4gICAgICAgICAgICAgICAgLnNlbGVjdCgnaWQsIHRpdGxlLCBkZXNjcmlwdGlvbicpXHJcbiAgICAgICAgICAgICAgICAuZXEoJ2lkJywgY291cnNlSWQpXHJcbiAgICAgICAgICAgICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIWNvdXJzZSkgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgbGlua2VkIHNvdXJjZSBpbmZvXHJcbiAgICAgICAgICAgIGNvbnN0IHsgZGF0YTogbWFwcGluZ3MgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcclxuICAgICAgICAgICAgICAgIC5mcm9tKCdsZXNzb25fc291cmNlX21hcHBpbmdzJylcclxuICAgICAgICAgICAgICAgIC5zZWxlY3QoJ3NvdXJjZV9pZCcpXHJcbiAgICAgICAgICAgICAgICAuZXEoJ21vZHVsZV9pZCcsIGNvdXJzZUlkKTtcclxuXHJcbiAgICAgICAgICAgIC8vIEdldCBzb3VyY2UgZGV0YWlscyB2aWEgbW9kdWxlc1xyXG4gICAgICAgICAgICBjb25zdCB7IGRhdGE6IG1vZHVsZXMgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcclxuICAgICAgICAgICAgICAgIC5mcm9tKCdtb2R1bGVzJylcclxuICAgICAgICAgICAgICAgIC5zZWxlY3QoJ2lkJylcclxuICAgICAgICAgICAgICAgIC5lcSgnY291cnNlX2lkJywgY291cnNlSWQpO1xyXG5cclxuICAgICAgICAgICAgbGV0IHNvdXJjZVVybDogc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICBsZXQgc291cmNlVHlwZTogc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG5cclxuICAgICAgICAgICAgaWYgKG1vZHVsZXMgJiYgbW9kdWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IGRhdGE6IG1hcHBpbmcgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcclxuICAgICAgICAgICAgICAgICAgICAuZnJvbSgnbGVzc29uX3NvdXJjZV9tYXBwaW5ncycpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNlbGVjdCgnc291cmNlX2lkJylcclxuICAgICAgICAgICAgICAgICAgICAuZXEoJ21vZHVsZV9pZCcsIG1vZHVsZXNbMF0uaWQpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChtYXBwaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBkYXRhOiBzb3VyY2UgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZyb20oJ3NvdXJjZXMnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2VsZWN0KCdzb3VyY2VfdXJsLCBzb3VyY2VfdHlwZScpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcSgnaWQnLCBtYXBwaW5nLnNvdXJjZV9pZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZVVybCA9IHNvdXJjZS5zb3VyY2VfdXJsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VUeXBlID0gc291cmNlLnNvdXJjZV90eXBlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGFuYWx5c2lzIGRhdGFcclxuICAgICAgICAgICAgbGV0IGFuYWx5c2lzVGV4dCA9ICcnO1xyXG4gICAgICAgICAgICBpZiAobW9kdWxlcyAmJiBtb2R1bGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgZGF0YTogbWFwcGluZyB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgICAgICAgICAgICAgIC5mcm9tKCdsZXNzb25fc291cmNlX21hcHBpbmdzJylcclxuICAgICAgICAgICAgICAgICAgICAuc2VsZWN0KCdzb3VyY2VfaWQnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5lcSgnbW9kdWxlX2lkJywgbW9kdWxlc1swXS5pZClcclxuICAgICAgICAgICAgICAgICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKG1hcHBpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB7IGRhdGE6IGFuYWx5c2lzRGF0YSB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZnJvbSgnc291cmNlX2FuYWx5c2VzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNlbGVjdCgnYW5hbHlzaXNfZGF0YScpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcSgnc291cmNlX2lkJywgbWFwcGluZy5zb3VyY2VfaWQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFuYWx5c2lzRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmFseXNpc1RleHQgPSBKU09OLnN0cmluZ2lmeShhbmFseXNpc0RhdGEuYW5hbHlzaXNfZGF0YSwgbnVsbCwgMik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgbGVzc29uIHBsYW4gdGV4dFxyXG4gICAgICAgICAgICBjb25zdCBsZXNzb25QbGFuVGV4dCA9IGF3YWl0IHRoaXMuZ2V0TGVzc29uUGxhblN1bW1hcnkoY291cnNlSWQpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBgTEVQOiAke2NvdXJzZS50aXRsZX1gLFxyXG4gICAgICAgICAgICAgICAgYW5hbHlzaXNUZXh0LFxyXG4gICAgICAgICAgICAgICAgbGVzc29uUGxhblRleHQ6IGxlc3NvblBsYW5UZXh0IHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgc291cmNlVXJsLFxyXG4gICAgICAgICAgICAgICAgc291cmNlVHlwZSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbTm90ZWJvb2tMTV0gRmFpbGVkIHRvIGdldCBub3RlYm9vayBjb250ZW50OicsIGVycm9yKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRm9ybWF0IGFuYWx5c2lzIGRhdGEgYXMgaHVtYW4tcmVhZGFibGUgdGV4dCBmb3IgTm90ZWJvb2tMTSBpbmdlc3Rpb24uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZm9ybWF0QW5hbHlzaXNBc1RleHQoYW5hbHlzaXM6IEFuYWx5c2lzRGF0YSwgY291cnNlVGl0bGU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgY29uc3Qgc2VjdGlvbnM6IHN0cmluZ1tdID0gW1xyXG4gICAgICAgICAgICBgIyBTb3VyY2UgQW5hbHlzaXM6ICR7Y291cnNlVGl0bGV9YCxcclxuICAgICAgICAgICAgYE1vZGVsOiAke2FuYWx5c2lzLm1vZGVsVXNlZCB8fCAnR2VtaW5pIDEuNSBQcm8nfWAsXHJcbiAgICAgICAgICAgICcnLFxyXG4gICAgICAgIF07XHJcblxyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBhbmFseXNpcy5hbmFseXNpc0RhdGE7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBkYXRhID09PSAnb2JqZWN0JyAmJiBkYXRhICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGRhdGEpKSB7XHJcbiAgICAgICAgICAgICAgICBzZWN0aW9ucy5wdXNoKGAjIyAke2tleX1gKTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VjdGlvbnMucHVzaCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlY3Rpb25zLnB1c2goSlNPTi5zdHJpbmdpZnkodmFsdWUsIG51bGwsIDIpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNlY3Rpb25zLnB1c2goJycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gc2VjdGlvbnMuam9pbignXFxuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBCdWlsZCBhIHRleHQgc3VtbWFyeSBvZiB0aGUgbGVzc29uIHBsYW4gZm9yIE5vdGVib29rTE0uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYXN5bmMgZ2V0TGVzc29uUGxhblN1bW1hcnkoY291cnNlSWQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgZGF0YTogbW9kdWxlcyB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgICAgICAgICAgLmZyb20oJ21vZHVsZXMnKVxyXG4gICAgICAgICAgICAgICAgLnNlbGVjdCgnaWQsIHRpdGxlLCBtb2R1bGVfbnVtYmVyLCBkZXNjcmlwdGlvbiwgZHVyYXRpb24nKVxyXG4gICAgICAgICAgICAgICAgLmVxKCdjb3Vyc2VfaWQnLCBjb3Vyc2VJZClcclxuICAgICAgICAgICAgICAgIC5vcmRlcignbW9kdWxlX251bWJlcicpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFtb2R1bGVzIHx8IG1vZHVsZXMubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHNlY3Rpb25zOiBzdHJpbmdbXSA9IFsnIyBHZW5lcmF0ZWQgTGVzc29uIFBsYW5cXG4nXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgbW9kIG9mIG1vZHVsZXMpIHtcclxuICAgICAgICAgICAgICAgIHNlY3Rpb25zLnB1c2goYCMjIE1vZHVsZSAke21vZC5tb2R1bGVfbnVtYmVyfTogJHttb2QudGl0bGV9YCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobW9kLmRlc2NyaXB0aW9uKSBzZWN0aW9ucy5wdXNoKG1vZC5kZXNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICBpZiAobW9kLmR1cmF0aW9uKSBzZWN0aW9ucy5wdXNoKGBEdXJhdGlvbjogJHttb2QuZHVyYXRpb259IG1pbnV0ZXNgKTtcclxuICAgICAgICAgICAgICAgIHNlY3Rpb25zLnB1c2goJycpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgZGF0YTogb2JqZWN0aXZlcyB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgICAgICAgICAgICAgIC5mcm9tKCdsZWFybmluZ19vYmplY3RpdmVzJylcclxuICAgICAgICAgICAgICAgICAgICAuc2VsZWN0KCdpZCwgb2JqZWN0aXZlX3R5cGUsIGNvbnRlbnQsIGJsb29tc19sZXZlbCwgb3JkZXJfaW5kZXgnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5lcSgnbW9kdWxlX2lkJywgbW9kLmlkKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vcmRlcignb3JkZXJfaW5kZXgnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAob2JqZWN0aXZlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgb2JqIG9mIG9iamVjdGl2ZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VjdGlvbnMucHVzaChgIyMjICR7b2JqLm9iamVjdGl2ZV90eXBlfTogJHtvYmouY29udGVudH1gKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VjdGlvbnMucHVzaChgQmxvb20ncyBMZXZlbDogJHtvYmouYmxvb21zX2xldmVsfWApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBkYXRhOiBhY3Rpdml0aWVzIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZnJvbSgnbGVhcm5pbmdfYWN0aXZpdGllcycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2VsZWN0KCdpbnN0cnVjdGlvbl9tZXRob2QsIGRlc2NyaXB0aW9uLCBkdXJhdGlvbicpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZXEoJ2xlYXJuaW5nX29iamVjdGl2ZV9pZCcsIG9iai5pZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vcmRlcignb3JkZXJfaW5kZXgnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpdml0aWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGFjdCBvZiBhY3Rpdml0aWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VjdGlvbnMucHVzaChgLSAqKiR7YWN0Lmluc3RydWN0aW9uX21ldGhvZH0qKiAoJHthY3QuZHVyYXRpb259IG1pbik6ICR7YWN0LmRlc2NyaXB0aW9ufWApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlY3Rpb25zLnB1c2goJycpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHNlY3Rpb25zLmpvaW4oJ1xcbicpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tOb3RlYm9va0xNXSBGYWlsZWQgdG8gYnVpbGQgbGVzc29uIHN1bW1hcnk6JywgZXJyb3IpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbImNyZWF0ZVNlcnZpY2VDbGllbnQiLCJOb3RlYm9va0xNU2VydmljZSIsImNvbnN0cnVjdG9yIiwic3VwYWJhc2UiLCJjcmVhdGVOb3RlYm9va0ZvckNvdXJzZSIsImNvdXJzZSIsImFuYWx5c2lzIiwic291cmNlVXJsIiwic291cmNlVHlwZSIsIm5vdGVib29rVGl0bGUiLCJ0aXRsZSIsInNvdXJjZXNBZGRlZCIsImFuYWx5c2lzVGV4dCIsImZvcm1hdEFuYWx5c2lzQXNUZXh0IiwibGVzc29uU3VtbWFyeSIsImdldExlc3NvblBsYW5TdW1tYXJ5IiwiaWQiLCJub3RlYm9va0lkIiwiRGF0ZSIsIm5vdyIsImVycm9yIiwiZnJvbSIsInVwZGF0ZSIsIm5vdGVib29rX2lkIiwiZXEiLCJjb25zb2xlIiwibWVzc2FnZSIsImxvZyIsImdldE5vdGVib29rQ29udGVudCIsImNvdXJzZUlkIiwiZGF0YSIsInNlbGVjdCIsInNpbmdsZSIsIm1hcHBpbmdzIiwibW9kdWxlcyIsImxlbmd0aCIsIm1hcHBpbmciLCJzb3VyY2UiLCJzb3VyY2VfaWQiLCJzb3VyY2VfdXJsIiwic291cmNlX3R5cGUiLCJhbmFseXNpc0RhdGEiLCJKU09OIiwic3RyaW5naWZ5IiwiYW5hbHlzaXNfZGF0YSIsImxlc3NvblBsYW5UZXh0IiwiY291cnNlVGl0bGUiLCJzZWN0aW9ucyIsIm1vZGVsVXNlZCIsImtleSIsInZhbHVlIiwiT2JqZWN0IiwiZW50cmllcyIsInB1c2giLCJqb2luIiwib3JkZXIiLCJtb2QiLCJtb2R1bGVfbnVtYmVyIiwiZGVzY3JpcHRpb24iLCJkdXJhdGlvbiIsIm9iamVjdGl2ZXMiLCJvYmoiLCJvYmplY3RpdmVfdHlwZSIsImNvbnRlbnQiLCJibG9vbXNfbGV2ZWwiLCJhY3Rpdml0aWVzIiwiYWN0IiwiaW5zdHJ1Y3Rpb25fbWV0aG9kIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/services/notebooklm/notebookService.ts\n");

/***/ }),

/***/ "(rsc)/./src/services/orchestrator.ts":
/*!**************************************!*\
  !*** ./src/services/orchestrator.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PipelineOrchestrator: () => (/* binding */ PipelineOrchestrator)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./src/lib/supabase/server.ts\");\n/* harmony import */ var _services_ai_openrouterService__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/services/ai/openrouterService */ \"(rsc)/./src/services/ai/openrouterService.ts\");\n/* harmony import */ var _services_notebooklm_notebookService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/services/notebooklm/notebookService */ \"(rsc)/./src/services/notebooklm/notebookService.ts\");\n/* harmony import */ var _services_sources_youtube__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/services/sources/youtube */ \"(rsc)/./src/services/sources/youtube.ts\");\n\n\n\n\nclass PipelineOrchestrator {\n    constructor(){\n        this.supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createServiceClient)();\n        this.ai = new _services_ai_openrouterService__WEBPACK_IMPORTED_MODULE_1__.OpenRouterService();\n        this.notebookLM = new _services_notebooklm_notebookService__WEBPACK_IMPORTED_MODULE_2__.NotebookLMService();\n    }\n    /**\r\n     * Full pipeline: source â†’ analysis â†’ lesson generation â†’ database save.\r\n     */ async processSourceToLesson(sourceUrl, sourceType, organizationId, onStatus, fileBuffer, fileName) {\n        console.log(\"[Pipeline] ====== STARTING PIPELINE ======\");\n        console.log(\"[Pipeline] sourceUrl:\", sourceUrl);\n        console.log(\"[Pipeline] sourceType:\", sourceType);\n        console.log(\"[Pipeline] organizationId:\", organizationId);\n        // Step 1: Create source record\n        console.log(\"[Pipeline] Step 1: Creating source record...\");\n        onStatus?.(\"Creating source record...\");\n        const source = await this.createSource(sourceUrl, sourceType, organizationId);\n        console.log(\"[Pipeline] Step 1 DONE â€” source.id:\", source.id);\n        try {\n            // Step 2: Update status to processing\n            console.log(\"[Pipeline] Step 2: Updating status to processing...\");\n            await this.updateSourceStatus(source.id, \"processing\");\n            console.log(\"[Pipeline] Step 2 DONE\");\n            // Step 3: Analyze content\n            console.log(\"[Pipeline] Step 3: Analyzing content...\");\n            onStatus?.(\"Analyzing content with Gemini AI...\");\n            const analysis = await this.analyzeSource(source.id, sourceUrl, sourceType, fileBuffer, fileName);\n            console.log(\"[Pipeline] Step 3 DONE â€” analysis keys:\", Object.keys(analysis));\n            // Step 4: Save analysis\n            console.log(\"[Pipeline] Step 4: Saving analysis...\");\n            onStatus?.(\"Saving analysis results...\");\n            await this.saveAnalysis(source.id, analysis);\n            console.log(\"[Pipeline] Step 4 DONE\");\n            // Step 5: Generate lesson \n            console.log(\"[Pipeline] Step 5: Generating lesson with OpenRouter...\");\n            onStatus?.(\"Generating IATA-compliant lesson plan with OpenRouter...\");\n            const title = await this.getSourceTitle(source.id);\n            console.log(\"[Pipeline] Step 5a: Got title:\", title);\n            const lesson = await this.ai.generateLesson(analysis.analysisData, title);\n            console.log(\"[Pipeline] Step 5 DONE â€” lesson.course.title:\", lesson?.course?.title);\n            // Step 6: Save to database\n            console.log(\"[Pipeline] Step 6: Saving lesson to DB...\");\n            onStatus?.(\"Saving lesson plan...\");\n            const courseId = await this.saveLesson(lesson, source.id, organizationId);\n            console.log(\"[Pipeline] Step 6 DONE â€” courseId:\", courseId);\n            // Step 7: Create NotebookLM notebook\n            console.log(\"[Pipeline] Step 7: Creating NotebookLM notebook...\");\n            onStatus?.(\"Preparing NotebookLM notebook...\");\n            try {\n                await this.notebookLM.createNotebookForCourse({\n                    id: courseId,\n                    title: lesson.course.title,\n                    description: lesson.course.description\n                }, // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                analysis, sourceUrl, sourceType);\n                console.log(\"[Pipeline] Step 7 DONE\");\n            } catch (nbError) {\n                // Non-fatal â€” log and continue\n                console.error(\"[Pipeline] NotebookLM creation failed (non-fatal):\", nbError);\n            }\n            // Step 8: Mark complete\n            console.log(\"[Pipeline] Step 8: Marking complete...\");\n            await this.updateSourceStatus(source.id, \"completed\");\n            onStatus?.(\"Complete!\");\n            console.log(\"[Pipeline] ====== PIPELINE COMPLETE ======\");\n            return {\n                courseId,\n                lesson\n            };\n        } catch (error) {\n            console.error(\"[Pipeline] ====== PIPELINE FAILED ======\");\n            console.error(\"[Pipeline] Error:\", error);\n            console.error(\"[Pipeline] Error message:\", error instanceof Error ? error.message : JSON.stringify(error));\n            console.error(\"[Pipeline] Error stack:\", error instanceof Error ? error.stack : \"N/A\");\n            await this.updateSourceStatus(source.id, \"failed\");\n            throw error;\n        }\n    }\n    async createSource(sourceUrl, sourceType, organizationId) {\n        let title = sourceUrl;\n        if (sourceType === \"youtube\") {\n            try {\n                const metadata = await _services_sources_youtube__WEBPACK_IMPORTED_MODULE_3__.YouTubeService.getMetadata(sourceUrl);\n                title = metadata.title;\n                console.log(\"[Pipeline] Got YouTube title:\", title);\n            } catch (ytErr) {\n                console.warn(\"[Pipeline] YouTube metadata fetch failed, using URL as title:\", ytErr);\n            }\n        }\n        const insertPayload = {\n            organization_id: organizationId,\n            source_type: sourceType,\n            source_url: sourceUrl,\n            title,\n            status: \"pending\"\n        };\n        console.log(\"[Pipeline] Inserting source with payload:\", JSON.stringify(insertPayload));\n        const { data, error } = await this.supabase.from(\"sources\").insert(insertPayload).select().single();\n        if (error) {\n            console.error(\"[Pipeline] createSource DB error:\", JSON.stringify(error));\n            throw new Error(`Failed to create source: ${error.message}`);\n        }\n        console.log(\"[Pipeline] createSource success, id:\", data.id);\n        return data;\n    }\n    async analyzeSource(sourceId, sourceUrl, sourceType, fileBuffer, fileName) {\n        if (sourceType === \"youtube\") {\n            const videoUrl = _services_sources_youtube__WEBPACK_IMPORTED_MODULE_3__.YouTubeService.getVideoUrl(sourceUrl);\n            // We'll need to fetch the transcript if we want high-quality analysis\n            // For now, let's pass a placeholder or implement transcript fetching if possible\n            return this.ai.analyzeVideo(videoUrl, sourceId);\n        }\n        if (!fileBuffer || !fileName) {\n            throw new Error(\"File buffer and name are required for document analysis\");\n        }\n        const mimeType = sourceType === \"pdf\" ? \"application/pdf\" : \"application/vnd.openxmlformats-officedocument.presentationml.presentation\";\n        return this.ai.analyzeDocument(fileBuffer, fileName, mimeType, sourceId);\n    }\n    async saveAnalysis(sourceId, analysis) {\n        const { error } = await this.supabase.from(\"source_analyses\").insert({\n            source_id: sourceId,\n            analysis_type: \"gemini_analysis\",\n            analysis_data: analysis.analysisData,\n            processing_time: analysis.processingTime,\n            cost: analysis.cost,\n            model_used: analysis.modelUsed\n        });\n        if (error) throw new Error(`Failed to save analysis: ${error.message}`);\n    }\n    async saveLesson(lesson, sourceId, organizationId) {\n        // Create course\n        const { data: course, error: courseError } = await this.supabase.from(\"courses\").insert({\n            organization_id: organizationId,\n            title: lesson.course.title,\n            description: lesson.course.description,\n            status: \"draft\"\n        }).select().single();\n        if (courseError) throw new Error(`Failed to create course: ${courseError.message}`);\n        // Create modules, objectives, and activities\n        for (const mod of lesson.modules){\n            const { data: module, error: modError } = await this.supabase.from(\"modules\").insert({\n                course_id: course.id,\n                module_number: mod.moduleNumber,\n                title: mod.title,\n                description: mod.description,\n                duration: mod.duration\n            }).select().single();\n            if (modError) throw new Error(`Failed to create module: ${modError.message}`);\n            // Create source â†” module mapping\n            await this.supabase.from(\"lesson_source_mappings\").insert({\n                source_id: sourceId,\n                module_id: module.id\n            });\n            // Create objectives and their activities\n            for(let i = 0; i < mod.objectives.length; i++){\n                const obj = mod.objectives[i];\n                const { data: objective, error: objError } = await this.supabase.from(\"learning_objectives\").insert({\n                    module_id: module.id,\n                    objective_type: obj.type,\n                    content: obj.content,\n                    blooms_level: obj.bloomsLevel,\n                    order_index: i\n                }).select().single();\n                if (objError) throw new Error(`Failed to create objective: ${objError.message}`);\n                // Create activities for this objective\n                for(let j = 0; j < obj.activities.length; j++){\n                    const act = obj.activities[j];\n                    const { error: actError } = await this.supabase.from(\"learning_activities\").insert({\n                        learning_objective_id: objective.id,\n                        instruction_method: act.instructionMethod,\n                        description: act.description,\n                        duration: act.duration,\n                        resources: act.resources,\n                        order_index: j\n                    });\n                    if (actError) throw new Error(`Failed to create activity: ${actError.message}`);\n                }\n            }\n        }\n        return course.id;\n    }\n    async updateSourceStatus(sourceId, status) {\n        await this.supabase.from(\"sources\").update({\n            status,\n            updated_at: new Date().toISOString()\n        }).eq(\"id\", sourceId);\n    }\n    async getSourceTitle(sourceId) {\n        const { data } = await this.supabase.from(\"sources\").select(\"title\").eq(\"id\", sourceId).single();\n        return data?.title || \"Untitled Source\";\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUssU0FBUzt3QkFDeEJSLGFBQWFDO29CQUNqQjtvQkFFSixJQUFJRyxVQUFVLE1BQU0sSUFBSTFELE1BQU0sQ0FBQywyQkFBMkIsRUFBRTBELFNBQVN6RCxPQUFPLENBQUMsQ0FBQztnQkFDbEY7WUFDSjtRQUNKO1FBRUEsT0FBT1IsT0FBT1osRUFBRTtJQUNwQjtJQUVBLE1BQWNDLG1CQUFtQnFDLFFBQWdCLEVBQUVOLE1BQWMsRUFBaUI7UUFDOUUsTUFBTSxJQUFJLENBQUM5QyxRQUFRLENBQ2RnRCxJQUFJLENBQUMsV0FDTGdELE1BQU0sQ0FBQztZQUFFbEQ7WUFBUW1ELFlBQVksSUFBSUMsT0FBT0MsV0FBVztRQUFHLEdBQ3REQyxFQUFFLENBQUMsTUFBTWhEO0lBQ2xCO0lBRUEsTUFBYzlCLGVBQWU4QixRQUFnQixFQUFtQjtRQUM1RCxNQUFNLEVBQUVMLElBQUksRUFBRSxHQUFHLE1BQU0sSUFBSSxDQUFDL0MsUUFBUSxDQUMvQmdELElBQUksQ0FBQyxXQUNMRSxNQUFNLENBQUMsU0FDUGtELEVBQUUsQ0FBQyxNQUFNaEQsVUFDVEQsTUFBTTtRQUNYLE9BQU9KLE1BQU0xQixTQUFTO0lBQzFCO0FBQ0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9sZWFybmluZy1wcm9kdWN0aW9uLWVuZ2luZS8uL3NyYy9zZXJ2aWNlcy9vcmNoZXN0cmF0b3IudHM/YjExNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVTZXJ2aWNlQ2xpZW50IH0gZnJvbSAnQC9saWIvc3VwYWJhc2Uvc2VydmVyJztcclxuaW1wb3J0IHsgT3BlblJvdXRlclNlcnZpY2UgfSBmcm9tICdAL3NlcnZpY2VzL2FpL29wZW5yb3V0ZXJTZXJ2aWNlJztcclxuaW1wb3J0IHsgTm90ZWJvb2tMTVNlcnZpY2UgfSBmcm9tICdAL3NlcnZpY2VzL25vdGVib29rbG0vbm90ZWJvb2tTZXJ2aWNlJztcclxuaW1wb3J0IHsgWW91VHViZVNlcnZpY2UgfSBmcm9tICdAL3NlcnZpY2VzL3NvdXJjZXMveW91dHViZSc7XHJcbmltcG9ydCB7IEdlbmVyYXRlZExlc3NvbiB9IGZyb20gJ0AvdHlwZXMvbGVzc29ucyc7XHJcbmltcG9ydCB7IFNvdXJjZUFuYWx5c2lzIH0gZnJvbSAnQC90eXBlcy9hbmFseXNpcyc7XHJcblxyXG50eXBlIFN0YXR1c0NhbGxiYWNrID0gKHN0YXR1czogc3RyaW5nKSA9PiB2b2lkO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBpcGVsaW5lT3JjaGVzdHJhdG9yIHtcclxuICAgIHByaXZhdGUgc3VwYWJhc2U7XHJcbiAgICBwcml2YXRlIGFpOiBPcGVuUm91dGVyU2VydmljZTtcclxuICAgIHByaXZhdGUgbm90ZWJvb2tMTTogTm90ZWJvb2tMTVNlcnZpY2U7XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5zdXBhYmFzZSA9IGNyZWF0ZVNlcnZpY2VDbGllbnQoKTtcclxuICAgICAgICB0aGlzLmFpID0gbmV3IE9wZW5Sb3V0ZXJTZXJ2aWNlKCk7XHJcbiAgICAgICAgdGhpcy5ub3RlYm9va0xNID0gbmV3IE5vdGVib29rTE1TZXJ2aWNlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGdWxsIHBpcGVsaW5lOiBzb3VyY2Ug4oaSIGFuYWx5c2lzIOKGkiBsZXNzb24gZ2VuZXJhdGlvbiDihpIgZGF0YWJhc2Ugc2F2ZS5cclxuICAgICAqL1xyXG4gICAgYXN5bmMgcHJvY2Vzc1NvdXJjZVRvTGVzc29uKFxyXG4gICAgICAgIHNvdXJjZVVybDogc3RyaW5nLFxyXG4gICAgICAgIHNvdXJjZVR5cGU6ICd5b3V0dWJlJyB8ICdwZGYnIHwgJ3BwdHgnLFxyXG4gICAgICAgIG9yZ2FuaXphdGlvbklkOiBzdHJpbmcsXHJcbiAgICAgICAgb25TdGF0dXM/OiBTdGF0dXNDYWxsYmFjayxcclxuICAgICAgICBmaWxlQnVmZmVyPzogQnVmZmVyLFxyXG4gICAgICAgIGZpbGVOYW1lPzogc3RyaW5nXHJcbiAgICApOiBQcm9taXNlPHsgY291cnNlSWQ6IHN0cmluZzsgbGVzc29uOiBHZW5lcmF0ZWRMZXNzb24gfT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbUGlwZWxpbmVdID09PT09PSBTVEFSVElORyBQSVBFTElORSA9PT09PT0nKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnW1BpcGVsaW5lXSBzb3VyY2VVcmw6Jywgc291cmNlVXJsKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnW1BpcGVsaW5lXSBzb3VyY2VUeXBlOicsIHNvdXJjZVR5cGUpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbUGlwZWxpbmVdIG9yZ2FuaXphdGlvbklkOicsIG9yZ2FuaXphdGlvbklkKTtcclxuXHJcbiAgICAgICAgLy8gU3RlcCAxOiBDcmVhdGUgc291cmNlIHJlY29yZFxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbUGlwZWxpbmVdIFN0ZXAgMTogQ3JlYXRpbmcgc291cmNlIHJlY29yZC4uLicpO1xyXG4gICAgICAgIG9uU3RhdHVzPy4oJ0NyZWF0aW5nIHNvdXJjZSByZWNvcmQuLi4nKTtcclxuICAgICAgICBjb25zdCBzb3VyY2UgPSBhd2FpdCB0aGlzLmNyZWF0ZVNvdXJjZShzb3VyY2VVcmwsIHNvdXJjZVR5cGUsIG9yZ2FuaXphdGlvbklkKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnW1BpcGVsaW5lXSBTdGVwIDEgRE9ORSDigJQgc291cmNlLmlkOicsIHNvdXJjZS5pZCk7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIFN0ZXAgMjogVXBkYXRlIHN0YXR1cyB0byBwcm9jZXNzaW5nXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbUGlwZWxpbmVdIFN0ZXAgMjogVXBkYXRpbmcgc3RhdHVzIHRvIHByb2Nlc3NpbmcuLi4nKTtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVTb3VyY2VTdGF0dXMoc291cmNlLmlkLCAncHJvY2Vzc2luZycpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW1BpcGVsaW5lXSBTdGVwIDIgRE9ORScpO1xyXG5cclxuICAgICAgICAgICAgLy8gU3RlcCAzOiBBbmFseXplIGNvbnRlbnRcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tQaXBlbGluZV0gU3RlcCAzOiBBbmFseXppbmcgY29udGVudC4uLicpO1xyXG4gICAgICAgICAgICBvblN0YXR1cz8uKCdBbmFseXppbmcgY29udGVudCB3aXRoIEdlbWluaSBBSS4uLicpO1xyXG4gICAgICAgICAgICBjb25zdCBhbmFseXNpcyA9IGF3YWl0IHRoaXMuYW5hbHl6ZVNvdXJjZShzb3VyY2UuaWQsIHNvdXJjZVVybCwgc291cmNlVHlwZSwgZmlsZUJ1ZmZlciwgZmlsZU5hbWUpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW1BpcGVsaW5lXSBTdGVwIDMgRE9ORSDigJQgYW5hbHlzaXMga2V5czonLCBPYmplY3Qua2V5cyhhbmFseXNpcykpO1xyXG5cclxuICAgICAgICAgICAgLy8gU3RlcCA0OiBTYXZlIGFuYWx5c2lzXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbUGlwZWxpbmVdIFN0ZXAgNDogU2F2aW5nIGFuYWx5c2lzLi4uJyk7XHJcbiAgICAgICAgICAgIG9uU3RhdHVzPy4oJ1NhdmluZyBhbmFseXNpcyByZXN1bHRzLi4uJyk7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZUFuYWx5c2lzKHNvdXJjZS5pZCwgYW5hbHlzaXMpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW1BpcGVsaW5lXSBTdGVwIDQgRE9ORScpO1xyXG5cclxuICAgICAgICAgICAgLy8gU3RlcCA1OiBHZW5lcmF0ZSBsZXNzb24gXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbUGlwZWxpbmVdIFN0ZXAgNTogR2VuZXJhdGluZyBsZXNzb24gd2l0aCBPcGVuUm91dGVyLi4uJyk7XHJcbiAgICAgICAgICAgIG9uU3RhdHVzPy4oJ0dlbmVyYXRpbmcgSUFUQS1jb21wbGlhbnQgbGVzc29uIHBsYW4gd2l0aCBPcGVuUm91dGVyLi4uJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRpdGxlID0gYXdhaXQgdGhpcy5nZXRTb3VyY2VUaXRsZShzb3VyY2UuaWQpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW1BpcGVsaW5lXSBTdGVwIDVhOiBHb3QgdGl0bGU6JywgdGl0bGUpO1xyXG4gICAgICAgICAgICBjb25zdCBsZXNzb24gPSBhd2FpdCB0aGlzLmFpLmdlbmVyYXRlTGVzc29uKFxyXG4gICAgICAgICAgICAgICAgYW5hbHlzaXMuYW5hbHlzaXNEYXRhLFxyXG4gICAgICAgICAgICAgICAgdGl0bGVcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tQaXBlbGluZV0gU3RlcCA1IERPTkUg4oCUIGxlc3Nvbi5jb3Vyc2UudGl0bGU6JywgbGVzc29uPy5jb3Vyc2U/LnRpdGxlKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFN0ZXAgNjogU2F2ZSB0byBkYXRhYmFzZVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW1BpcGVsaW5lXSBTdGVwIDY6IFNhdmluZyBsZXNzb24gdG8gREIuLi4nKTtcclxuICAgICAgICAgICAgb25TdGF0dXM/LignU2F2aW5nIGxlc3NvbiBwbGFuLi4uJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvdXJzZUlkID0gYXdhaXQgdGhpcy5zYXZlTGVzc29uKGxlc3Nvbiwgc291cmNlLmlkLCBvcmdhbml6YXRpb25JZCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbUGlwZWxpbmVdIFN0ZXAgNiBET05FIOKAlCBjb3Vyc2VJZDonLCBjb3Vyc2VJZCk7XHJcblxyXG4gICAgICAgICAgICAvLyBTdGVwIDc6IENyZWF0ZSBOb3RlYm9va0xNIG5vdGVib29rXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbUGlwZWxpbmVdIFN0ZXAgNzogQ3JlYXRpbmcgTm90ZWJvb2tMTSBub3RlYm9vay4uLicpO1xyXG4gICAgICAgICAgICBvblN0YXR1cz8uKCdQcmVwYXJpbmcgTm90ZWJvb2tMTSBub3RlYm9vay4uLicpO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5ub3RlYm9va0xNLmNyZWF0ZU5vdGVib29rRm9yQ291cnNlKFxyXG4gICAgICAgICAgICAgICAgICAgIHsgaWQ6IGNvdXJzZUlkLCB0aXRsZTogbGVzc29uLmNvdXJzZS50aXRsZSwgZGVzY3JpcHRpb246IGxlc3Nvbi5jb3Vyc2UuZGVzY3JpcHRpb24gfSxcclxuICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxyXG4gICAgICAgICAgICAgICAgICAgIGFuYWx5c2lzIGFzIGFueSxcclxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VVcmwsXHJcbiAgICAgICAgICAgICAgICAgICAgc291cmNlVHlwZVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbUGlwZWxpbmVdIFN0ZXAgNyBET05FJyk7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKG5iRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIC8vIE5vbi1mYXRhbCDigJQgbG9nIGFuZCBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignW1BpcGVsaW5lXSBOb3RlYm9va0xNIGNyZWF0aW9uIGZhaWxlZCAobm9uLWZhdGFsKTonLCBuYkVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gU3RlcCA4OiBNYXJrIGNvbXBsZXRlXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbUGlwZWxpbmVdIFN0ZXAgODogTWFya2luZyBjb21wbGV0ZS4uLicpO1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZVNvdXJjZVN0YXR1cyhzb3VyY2UuaWQsICdjb21wbGV0ZWQnKTtcclxuICAgICAgICAgICAgb25TdGF0dXM/LignQ29tcGxldGUhJyk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbUGlwZWxpbmVdID09PT09PSBQSVBFTElORSBDT01QTEVURSA9PT09PT0nKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB7IGNvdXJzZUlkLCBsZXNzb24gfTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbUGlwZWxpbmVdID09PT09PSBQSVBFTElORSBGQUlMRUQgPT09PT09Jyk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tQaXBlbGluZV0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbUGlwZWxpbmVdIEVycm9yIG1lc3NhZ2U6JywgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBKU09OLnN0cmluZ2lmeShlcnJvcikpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbUGlwZWxpbmVdIEVycm9yIHN0YWNrOicsIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5zdGFjayA6ICdOL0EnKTtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVTb3VyY2VTdGF0dXMoc291cmNlLmlkLCAnZmFpbGVkJyk7XHJcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFzeW5jIGNyZWF0ZVNvdXJjZShcclxuICAgICAgICBzb3VyY2VVcmw6IHN0cmluZyxcclxuICAgICAgICBzb3VyY2VUeXBlOiAneW91dHViZScgfCAncGRmJyB8ICdwcHR4JyxcclxuICAgICAgICBvcmdhbml6YXRpb25JZDogc3RyaW5nXHJcbiAgICApIHtcclxuICAgICAgICBsZXQgdGl0bGUgPSBzb3VyY2VVcmw7XHJcblxyXG4gICAgICAgIGlmIChzb3VyY2VUeXBlID09PSAneW91dHViZScpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1ldGFkYXRhID0gYXdhaXQgWW91VHViZVNlcnZpY2UuZ2V0TWV0YWRhdGEoc291cmNlVXJsKTtcclxuICAgICAgICAgICAgICAgIHRpdGxlID0gbWV0YWRhdGEudGl0bGU7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW1BpcGVsaW5lXSBHb3QgWW91VHViZSB0aXRsZTonLCB0aXRsZSk7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKHl0RXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1tQaXBlbGluZV0gWW91VHViZSBtZXRhZGF0YSBmZXRjaCBmYWlsZWQsIHVzaW5nIFVSTCBhcyB0aXRsZTonLCB5dEVycik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGluc2VydFBheWxvYWQgPSB7XHJcbiAgICAgICAgICAgIG9yZ2FuaXphdGlvbl9pZDogb3JnYW5pemF0aW9uSWQsXHJcbiAgICAgICAgICAgIHNvdXJjZV90eXBlOiBzb3VyY2VUeXBlLFxyXG4gICAgICAgICAgICBzb3VyY2VfdXJsOiBzb3VyY2VVcmwsXHJcbiAgICAgICAgICAgIHRpdGxlLFxyXG4gICAgICAgICAgICBzdGF0dXM6ICdwZW5kaW5nJyxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbUGlwZWxpbmVdIEluc2VydGluZyBzb3VyY2Ugd2l0aCBwYXlsb2FkOicsIEpTT04uc3RyaW5naWZ5KGluc2VydFBheWxvYWQpKTtcclxuXHJcbiAgICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgICAgICAuZnJvbSgnc291cmNlcycpXHJcbiAgICAgICAgICAgIC5pbnNlcnQoaW5zZXJ0UGF5bG9hZClcclxuICAgICAgICAgICAgLnNlbGVjdCgpXHJcbiAgICAgICAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tQaXBlbGluZV0gY3JlYXRlU291cmNlIERCIGVycm9yOicsIEpTT04uc3RyaW5naWZ5KGVycm9yKSk7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGNyZWF0ZSBzb3VyY2U6ICR7ZXJyb3IubWVzc2FnZX1gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1tQaXBlbGluZV0gY3JlYXRlU291cmNlIHN1Y2Nlc3MsIGlkOicsIGRhdGEuaWQpO1xyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXN5bmMgYW5hbHl6ZVNvdXJjZShcclxuICAgICAgICBzb3VyY2VJZDogc3RyaW5nLFxyXG4gICAgICAgIHNvdXJjZVVybDogc3RyaW5nLFxyXG4gICAgICAgIHNvdXJjZVR5cGU6ICd5b3V0dWJlJyB8ICdwZGYnIHwgJ3BwdHgnLFxyXG4gICAgICAgIGZpbGVCdWZmZXI/OiBCdWZmZXIsXHJcbiAgICAgICAgZmlsZU5hbWU/OiBzdHJpbmdcclxuICAgICk6IFByb21pc2U8U291cmNlQW5hbHlzaXM+IHtcclxuICAgICAgICBpZiAoc291cmNlVHlwZSA9PT0gJ3lvdXR1YmUnKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZpZGVvVXJsID0gWW91VHViZVNlcnZpY2UuZ2V0VmlkZW9Vcmwoc291cmNlVXJsKTtcclxuICAgICAgICAgICAgLy8gV2UnbGwgbmVlZCB0byBmZXRjaCB0aGUgdHJhbnNjcmlwdCBpZiB3ZSB3YW50IGhpZ2gtcXVhbGl0eSBhbmFseXNpc1xyXG4gICAgICAgICAgICAvLyBGb3Igbm93LCBsZXQncyBwYXNzIGEgcGxhY2Vob2xkZXIgb3IgaW1wbGVtZW50IHRyYW5zY3JpcHQgZmV0Y2hpbmcgaWYgcG9zc2libGVcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWkuYW5hbHl6ZVZpZGVvKHZpZGVvVXJsLCBzb3VyY2VJZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIWZpbGVCdWZmZXIgfHwgIWZpbGVOYW1lKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmlsZSBidWZmZXIgYW5kIG5hbWUgYXJlIHJlcXVpcmVkIGZvciBkb2N1bWVudCBhbmFseXNpcycpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgbWltZVR5cGUgPVxyXG4gICAgICAgICAgICBzb3VyY2VUeXBlID09PSAncGRmJ1xyXG4gICAgICAgICAgICAgICAgPyAnYXBwbGljYXRpb24vcGRmJ1xyXG4gICAgICAgICAgICAgICAgOiAnYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnByZXNlbnRhdGlvbm1sLnByZXNlbnRhdGlvbic7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmFpLmFuYWx5emVEb2N1bWVudChmaWxlQnVmZmVyLCBmaWxlTmFtZSwgbWltZVR5cGUsIHNvdXJjZUlkKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFzeW5jIHNhdmVBbmFseXNpcyhzb3VyY2VJZDogc3RyaW5nLCBhbmFseXNpczogU291cmNlQW5hbHlzaXMpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlLmZyb20oJ3NvdXJjZV9hbmFseXNlcycpLmluc2VydCh7XHJcbiAgICAgICAgICAgIHNvdXJjZV9pZDogc291cmNlSWQsXHJcbiAgICAgICAgICAgIGFuYWx5c2lzX3R5cGU6ICdnZW1pbmlfYW5hbHlzaXMnLFxyXG4gICAgICAgICAgICBhbmFseXNpc19kYXRhOiBhbmFseXNpcy5hbmFseXNpc0RhdGEsXHJcbiAgICAgICAgICAgIHByb2Nlc3NpbmdfdGltZTogYW5hbHlzaXMucHJvY2Vzc2luZ1RpbWUsXHJcbiAgICAgICAgICAgIGNvc3Q6IGFuYWx5c2lzLmNvc3QsXHJcbiAgICAgICAgICAgIG1vZGVsX3VzZWQ6IGFuYWx5c2lzLm1vZGVsVXNlZCxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKGVycm9yKSB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBzYXZlIGFuYWx5c2lzOiAke2Vycm9yLm1lc3NhZ2V9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyBzYXZlTGVzc29uKFxyXG4gICAgICAgIGxlc3NvbjogR2VuZXJhdGVkTGVzc29uLFxyXG4gICAgICAgIHNvdXJjZUlkOiBzdHJpbmcsXHJcbiAgICAgICAgb3JnYW5pemF0aW9uSWQ6IHN0cmluZ1xyXG4gICAgKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgICAgICAvLyBDcmVhdGUgY291cnNlXHJcbiAgICAgICAgY29uc3QgeyBkYXRhOiBjb3Vyc2UsIGVycm9yOiBjb3Vyc2VFcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgICAgICAuZnJvbSgnY291cnNlcycpXHJcbiAgICAgICAgICAgIC5pbnNlcnQoe1xyXG4gICAgICAgICAgICAgICAgb3JnYW5pemF0aW9uX2lkOiBvcmdhbml6YXRpb25JZCxcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBsZXNzb24uY291cnNlLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGxlc3Nvbi5jb3Vyc2UuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6ICdkcmFmdCcsXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAgICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgICAgIGlmIChjb3Vyc2VFcnJvcikgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY3JlYXRlIGNvdXJzZTogJHtjb3Vyc2VFcnJvci5tZXNzYWdlfWApO1xyXG5cclxuICAgICAgICAvLyBDcmVhdGUgbW9kdWxlcywgb2JqZWN0aXZlcywgYW5kIGFjdGl2aXRpZXNcclxuICAgICAgICBmb3IgKGNvbnN0IG1vZCBvZiBsZXNzb24ubW9kdWxlcykge1xyXG4gICAgICAgICAgICBjb25zdCB7IGRhdGE6IG1vZHVsZSwgZXJyb3I6IG1vZEVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXHJcbiAgICAgICAgICAgICAgICAuZnJvbSgnbW9kdWxlcycpXHJcbiAgICAgICAgICAgICAgICAuaW5zZXJ0KHtcclxuICAgICAgICAgICAgICAgICAgICBjb3Vyc2VfaWQ6IGNvdXJzZS5pZCxcclxuICAgICAgICAgICAgICAgICAgICBtb2R1bGVfbnVtYmVyOiBtb2QubW9kdWxlTnVtYmVyLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBtb2QudGl0bGUsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IG1vZC5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogbW9kLmR1cmF0aW9uLFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAgICAgICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKG1vZEVycm9yKSB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBjcmVhdGUgbW9kdWxlOiAke21vZEVycm9yLm1lc3NhZ2V9YCk7XHJcblxyXG4gICAgICAgICAgICAvLyBDcmVhdGUgc291cmNlIOKGlCBtb2R1bGUgbWFwcGluZ1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnN1cGFiYXNlLmZyb20oJ2xlc3Nvbl9zb3VyY2VfbWFwcGluZ3MnKS5pbnNlcnQoe1xyXG4gICAgICAgICAgICAgICAgc291cmNlX2lkOiBzb3VyY2VJZCxcclxuICAgICAgICAgICAgICAgIG1vZHVsZV9pZDogbW9kdWxlLmlkLFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIENyZWF0ZSBvYmplY3RpdmVzIGFuZCB0aGVpciBhY3Rpdml0aWVzXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbW9kLm9iamVjdGl2ZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG9iaiA9IG1vZC5vYmplY3RpdmVzW2ldO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgZGF0YTogb2JqZWN0aXZlLCBlcnJvcjogb2JqRXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcclxuICAgICAgICAgICAgICAgICAgICAuZnJvbSgnbGVhcm5pbmdfb2JqZWN0aXZlcycpXHJcbiAgICAgICAgICAgICAgICAgICAgLmluc2VydCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZV9pZDogbW9kdWxlLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RpdmVfdHlwZTogb2JqLnR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IG9iai5jb250ZW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBibG9vbXNfbGV2ZWw6IG9iai5ibG9vbXNMZXZlbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXJfaW5kZXg6IGksXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuc2VsZWN0KClcclxuICAgICAgICAgICAgICAgICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKG9iakVycm9yKSB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBjcmVhdGUgb2JqZWN0aXZlOiAke29iakVycm9yLm1lc3NhZ2V9YCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGFjdGl2aXRpZXMgZm9yIHRoaXMgb2JqZWN0aXZlXHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IG9iai5hY3Rpdml0aWVzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWN0ID0gb2JqLmFjdGl2aXRpZXNbal07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgZXJyb3I6IGFjdEVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5mcm9tKCdsZWFybmluZ19hY3Rpdml0aWVzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmluc2VydCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWFybmluZ19vYmplY3RpdmVfaWQ6IG9iamVjdGl2ZS5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RydWN0aW9uX21ldGhvZDogYWN0Lmluc3RydWN0aW9uTWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGFjdC5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBhY3QuZHVyYXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZXM6IGFjdC5yZXNvdXJjZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlcl9pbmRleDogaixcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3RFcnJvcikgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY3JlYXRlIGFjdGl2aXR5OiAke2FjdEVycm9yLm1lc3NhZ2V9YCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBjb3Vyc2UuaWQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyB1cGRhdGVTb3VyY2VTdGF0dXMoc291cmNlSWQ6IHN0cmluZywgc3RhdHVzOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICBhd2FpdCB0aGlzLnN1cGFiYXNlXHJcbiAgICAgICAgICAgIC5mcm9tKCdzb3VyY2VzJylcclxuICAgICAgICAgICAgLnVwZGF0ZSh7IHN0YXR1cywgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpIH0pXHJcbiAgICAgICAgICAgIC5lcSgnaWQnLCBzb3VyY2VJZCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyBnZXRTb3VyY2VUaXRsZShzb3VyY2VJZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgICAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcclxuICAgICAgICAgICAgLmZyb20oJ3NvdXJjZXMnKVxyXG4gICAgICAgICAgICAuc2VsZWN0KCd0aXRsZScpXHJcbiAgICAgICAgICAgIC5lcSgnaWQnLCBzb3VyY2VJZClcclxuICAgICAgICAgICAgLnNpbmdsZSgpO1xyXG4gICAgICAgIHJldHVybiBkYXRhPy50aXRsZSB8fCAnVW50aXRsZWQgU291cmNlJztcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOlsiY3JlYXRlU2VydmljZUNsaWVudCIsIk9wZW5Sb3V0ZXJTZXJ2aWNlIiwiTm90ZWJvb2tMTVNlcnZpY2UiLCJZb3VUdWJlU2VydmljZSIsIlBpcGVsaW5lT3JjaGVzdHJhdG9yIiwiY29uc3RydWN0b3IiLCJzdXBhYmFzZSIsImFpIiwibm90ZWJvb2tMTSIsInByb2Nlc3NTb3VyY2VUb0xlc3NvbiIsInNvdXJjZVVybCIsInNvdXJjZVR5cGUiLCJvcmdhbml6YXRpb25JZCIsIm9uU3RhdHVzIiwiZmlsZUJ1ZmZlciIsImZpbGVOYW1lIiwiY29uc29sZSIsImxvZyIsInNvdXJjZSIsImNyZWF0ZVNvdXJjZSIsImlkIiwidXBkYXRlU291cmNlU3RhdHVzIiwiYW5hbHlzaXMiLCJhbmFseXplU291cmNlIiwiT2JqZWN0Iiwia2V5cyIsInNhdmVBbmFseXNpcyIsInRpdGxlIiwiZ2V0U291cmNlVGl0bGUiLCJsZXNzb24iLCJnZW5lcmF0ZUxlc3NvbiIsImFuYWx5c2lzRGF0YSIsImNvdXJzZSIsImNvdXJzZUlkIiwic2F2ZUxlc3NvbiIsImNyZWF0ZU5vdGVib29rRm9yQ291cnNlIiwiZGVzY3JpcHRpb24iLCJuYkVycm9yIiwiZXJyb3IiLCJFcnJvciIsIm1lc3NhZ2UiLCJKU09OIiwic3RyaW5naWZ5Iiwic3RhY2siLCJtZXRhZGF0YSIsImdldE1ldGFkYXRhIiwieXRFcnIiLCJ3YXJuIiwiaW5zZXJ0UGF5bG9hZCIsIm9yZ2FuaXphdGlvbl9pZCIsInNvdXJjZV90eXBlIiwic291cmNlX3VybCIsInN0YXR1cyIsImRhdGEiLCJmcm9tIiwiaW5zZXJ0Iiwic2VsZWN0Iiwic2luZ2xlIiwic291cmNlSWQiLCJ2aWRlb1VybCIsImdldFZpZGVvVXJsIiwiYW5hbHl6ZVZpZGVvIiwibWltZVR5cGUiLCJhbmFseXplRG9jdW1lbnQiLCJzb3VyY2VfaWQiLCJhbmFseXNpc190eXBlIiwiYW5hbHlzaXNfZGF0YSIsInByb2Nlc3NpbmdfdGltZSIsInByb2Nlc3NpbmdUaW1lIiwiY29zdCIsIm1vZGVsX3VzZWQiLCJtb2RlbFVzZWQiLCJjb3Vyc2VFcnJvciIsIm1vZCIsIm1vZHVsZXMiLCJtb2R1bGUiLCJtb2RFcnJvciIsImNvdXJzZV9pZCIsIm1vZHVsZV9udW1iZXIiLCJtb2R1bGVOdW1iZXIiLCJkdXJhdGlvbiIsIm1vZHVsZV9pZCIsImkiLCJvYmplY3RpdmVzIiwibGVuZ3RoIiwib2JqIiwib2JqZWN0aXZlIiwib2JqRXJyb3IiLCJvYmplY3RpdmVfdHlwZSIsInR5cGUiLCJjb250ZW50IiwiYmxvb21zX2xldmVsIiwiYmxvb21zTGV2ZWwiLCJvcmRlcl9pbmRleCIsImoiLCJhY3Rpdml0aWVzIiwiYWN0IiwiYWN0RXJyb3IiLCJsZWFybmluZ19vYmplY3RpdmVfaWQiLCJpbnN0cnVjdGlvbl9tZXRob2QiLCJpbnN0cnVjdGlvbk1ldGhvZCIsInJlc291cmNlcyIsInVwZGF0ZSIsInVwZGF0ZWRfYXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJlcSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/services/orchestrator.ts\n");

/***/ }),

/***/ "(rsc)/./src/services/sources/youtube.ts":
/*!*****************************************!*\
  !*** ./src/services/sources/youtube.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   YouTubeService: () => (/* binding */ YouTubeService)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ \"(rsc)/./node_modules/axios/lib/axios.js\");\n\nclass YouTubeService {\n    /**\r\n     * Validates a YouTube URL and returns the video ID.\r\n     */ static extractVideoId(url) {\n        const patterns = [\n            /(?:youtube\\.com\\/watch\\?v=)([a-zA-Z0-9_-]{11})/,\n            /(?:youtu\\.be\\/)([a-zA-Z0-9_-]{11})/,\n            /(?:youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/,\n            /(?:youtube\\.com\\/shorts\\/)([a-zA-Z0-9_-]{11})/\n        ];\n        for (const pattern of patterns){\n            const match = url.match(pattern);\n            if (match) return match[1];\n        }\n        return null;\n    }\n    /**\r\n     * Fetches video metadata using the oEmbed API (no API key required).\r\n     */ static async getMetadata(url) {\n        const videoId = this.extractVideoId(url);\n        if (!videoId) {\n            throw new Error(\"Invalid YouTube URL\");\n        }\n        try {\n            const oembedUrl = `https://www.youtube.com/oembed?url=https://www.youtube.com/watch?v=${videoId}&format=json`;\n            const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(oembedUrl);\n            return {\n                title: response.data.title || \"Untitled\",\n                duration: 0,\n                thumbnailUrl: `https://img.youtube.com/vi/${videoId}/maxresdefault.jpg`,\n                channelName: response.data.author_name || \"Unknown\",\n                description: \"\"\n            };\n        } catch  {\n            // Fallback metadata\n            return {\n                title: \"YouTube Video\",\n                duration: 0,\n                thumbnailUrl: `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`,\n                channelName: \"Unknown\",\n                description: \"\"\n            };\n        }\n    }\n    /**\r\n     * Validates that a YouTube URL is processable.\r\n     */ static async validate(url) {\n        const videoId = this.extractVideoId(url);\n        if (!videoId) {\n            return {\n                valid: false,\n                error: \"Invalid YouTube URL format\"\n            };\n        }\n        try {\n            await this.getMetadata(url);\n            return {\n                valid: true\n            };\n        } catch  {\n            return {\n                valid: false,\n                error: \"Could not access video. It may be private or unavailable.\"\n            };\n        }\n    }\n    /**\r\n     * Returns the direct YouTube URL for Gemini's native video understanding.\r\n     * Gemini 1.5 Pro can analyze YouTube videos directly via URL â€” no download needed.\r\n     */ static getVideoUrl(url) {\n        const videoId = this.extractVideoId(url);\n        if (!videoId) throw new Error(\"Invalid YouTube URL\");\n        return `https://www.youtube.com/watch?v=${videoId}`;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmljZXMvc291cmNlcy95b3V0dWJlLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQTBCO0FBV25CLE1BQU1DO0lBQ1Q7O0tBRUMsR0FDRCxPQUFPQyxlQUFlQyxHQUFXLEVBQWlCO1FBQzlDLE1BQU1DLFdBQVc7WUFDYjtZQUNBO1lBQ0E7WUFDQTtTQUNIO1FBRUQsS0FBSyxNQUFNQyxXQUFXRCxTQUFVO1lBQzVCLE1BQU1FLFFBQVFILElBQUlHLEtBQUssQ0FBQ0Q7WUFDeEIsSUFBSUMsT0FBTyxPQUFPQSxLQUFLLENBQUMsRUFBRTtRQUM5QjtRQUNBLE9BQU87SUFDWDtJQUVBOztLQUVDLEdBQ0QsYUFBYUMsWUFBWUosR0FBVyxFQUEwQjtRQUMxRCxNQUFNSyxVQUFVLElBQUksQ0FBQ04sY0FBYyxDQUFDQztRQUNwQyxJQUFJLENBQUNLLFNBQVM7WUFDVixNQUFNLElBQUlDLE1BQU07UUFDcEI7UUFFQSxJQUFJO1lBQ0EsTUFBTUMsWUFBWSxDQUFDLG1FQUFtRSxFQUFFRixRQUFRLFlBQVksQ0FBQztZQUM3RyxNQUFNRyxXQUFXLE1BQU1YLDZDQUFLQSxDQUFDWSxHQUFHLENBQUNGO1lBRWpDLE9BQU87Z0JBQ0hHLE9BQU9GLFNBQVNHLElBQUksQ0FBQ0QsS0FBSyxJQUFJO2dCQUM5QkUsVUFBVTtnQkFDVkMsY0FBYyxDQUFDLDJCQUEyQixFQUFFUixRQUFRLGtCQUFrQixDQUFDO2dCQUN2RVMsYUFBYU4sU0FBU0csSUFBSSxDQUFDSSxXQUFXLElBQUk7Z0JBQzFDQyxhQUFhO1lBQ2pCO1FBQ0osRUFBRSxPQUFNO1lBQ0osb0JBQW9CO1lBQ3BCLE9BQU87Z0JBQ0hOLE9BQU87Z0JBQ1BFLFVBQVU7Z0JBQ1ZDLGNBQWMsQ0FBQywyQkFBMkIsRUFBRVIsUUFBUSxjQUFjLENBQUM7Z0JBQ25FUyxhQUFhO2dCQUNiRSxhQUFhO1lBQ2pCO1FBQ0o7SUFDSjtJQUVBOztLQUVDLEdBQ0QsYUFBYUMsU0FBU2pCLEdBQVcsRUFBK0M7UUFDNUUsTUFBTUssVUFBVSxJQUFJLENBQUNOLGNBQWMsQ0FBQ0M7UUFDcEMsSUFBSSxDQUFDSyxTQUFTO1lBQ1YsT0FBTztnQkFBRWEsT0FBTztnQkFBT0MsT0FBTztZQUE2QjtRQUMvRDtRQUVBLElBQUk7WUFDQSxNQUFNLElBQUksQ0FBQ2YsV0FBVyxDQUFDSjtZQUN2QixPQUFPO2dCQUFFa0IsT0FBTztZQUFLO1FBQ3pCLEVBQUUsT0FBTTtZQUNKLE9BQU87Z0JBQUVBLE9BQU87Z0JBQU9DLE9BQU87WUFBNEQ7UUFDOUY7SUFDSjtJQUVBOzs7S0FHQyxHQUNELE9BQU9DLFlBQVlwQixHQUFXLEVBQVU7UUFDcEMsTUFBTUssVUFBVSxJQUFJLENBQUNOLGNBQWMsQ0FBQ0M7UUFDcEMsSUFBSSxDQUFDSyxTQUFTLE1BQU0sSUFBSUMsTUFBTTtRQUM5QixPQUFPLENBQUMsZ0NBQWdDLEVBQUVELFFBQVEsQ0FBQztJQUN2RDtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbGVhcm5pbmctcHJvZHVjdGlvbi1lbmdpbmUvLi9zcmMvc2VydmljZXMvc291cmNlcy95b3V0dWJlLnRzPzgzNDEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJztcclxuaW1wb3J0IHsgY29uZmlnIH0gZnJvbSAnQC9saWIvY29uZmlnJztcclxuXHJcbmludGVyZmFjZSBWaWRlb01ldGFkYXRhIHtcclxuICAgIHRpdGxlOiBzdHJpbmc7XHJcbiAgICBkdXJhdGlvbjogbnVtYmVyO1xyXG4gICAgdGh1bWJuYWlsVXJsOiBzdHJpbmc7XHJcbiAgICBjaGFubmVsTmFtZTogc3RyaW5nO1xyXG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFlvdVR1YmVTZXJ2aWNlIHtcclxuICAgIC8qKlxyXG4gICAgICogVmFsaWRhdGVzIGEgWW91VHViZSBVUkwgYW5kIHJldHVybnMgdGhlIHZpZGVvIElELlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgZXh0cmFjdFZpZGVvSWQodXJsOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcclxuICAgICAgICBjb25zdCBwYXR0ZXJucyA9IFtcclxuICAgICAgICAgICAgLyg/OnlvdXR1YmVcXC5jb21cXC93YXRjaFxcP3Y9KShbYS16QS1aMC05Xy1dezExfSkvLFxyXG4gICAgICAgICAgICAvKD86eW91dHVcXC5iZVxcLykoW2EtekEtWjAtOV8tXXsxMX0pLyxcclxuICAgICAgICAgICAgLyg/OnlvdXR1YmVcXC5jb21cXC9lbWJlZFxcLykoW2EtekEtWjAtOV8tXXsxMX0pLyxcclxuICAgICAgICAgICAgLyg/OnlvdXR1YmVcXC5jb21cXC9zaG9ydHNcXC8pKFthLXpBLVowLTlfLV17MTF9KS8sXHJcbiAgICAgICAgXTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHBhdHRlcm5zKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gdXJsLm1hdGNoKHBhdHRlcm4pO1xyXG4gICAgICAgICAgICBpZiAobWF0Y2gpIHJldHVybiBtYXRjaFsxXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGZXRjaGVzIHZpZGVvIG1ldGFkYXRhIHVzaW5nIHRoZSBvRW1iZWQgQVBJIChubyBBUEkga2V5IHJlcXVpcmVkKS5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGFzeW5jIGdldE1ldGFkYXRhKHVybDogc3RyaW5nKTogUHJvbWlzZTxWaWRlb01ldGFkYXRhPiB7XHJcbiAgICAgICAgY29uc3QgdmlkZW9JZCA9IHRoaXMuZXh0cmFjdFZpZGVvSWQodXJsKTtcclxuICAgICAgICBpZiAoIXZpZGVvSWQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIFlvdVR1YmUgVVJMJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBvZW1iZWRVcmwgPSBgaHR0cHM6Ly93d3cueW91dHViZS5jb20vb2VtYmVkP3VybD1odHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PSR7dmlkZW9JZH0mZm9ybWF0PWpzb25gO1xyXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLmdldChvZW1iZWRVcmwpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLnRpdGxlIHx8ICdVbnRpdGxlZCcsXHJcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMCwgLy8gb0VtYmVkIGRvZXNuJ3QgcmV0dXJuIGR1cmF0aW9uOyBHZW1pbmkgaGFuZGxlcyB2aWRlbyBhbmFseXNpcyBkaXJlY3RseVxyXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsVXJsOiBgaHR0cHM6Ly9pbWcueW91dHViZS5jb20vdmkvJHt2aWRlb0lkfS9tYXhyZXNkZWZhdWx0LmpwZ2AsXHJcbiAgICAgICAgICAgICAgICBjaGFubmVsTmFtZTogcmVzcG9uc2UuZGF0YS5hdXRob3JfbmFtZSB8fCAnVW5rbm93bicsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJycsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgICAgIC8vIEZhbGxiYWNrIG1ldGFkYXRhXHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1lvdVR1YmUgVmlkZW8nLFxyXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDAsXHJcbiAgICAgICAgICAgICAgICB0aHVtYm5haWxVcmw6IGBodHRwczovL2ltZy55b3V0dWJlLmNvbS92aS8ke3ZpZGVvSWR9L2hxZGVmYXVsdC5qcGdgLFxyXG4gICAgICAgICAgICAgICAgY2hhbm5lbE5hbWU6ICdVbmtub3duJyxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnJyxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBWYWxpZGF0ZXMgdGhhdCBhIFlvdVR1YmUgVVJMIGlzIHByb2Nlc3NhYmxlLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgYXN5bmMgdmFsaWRhdGUodXJsOiBzdHJpbmcpOiBQcm9taXNlPHsgdmFsaWQ6IGJvb2xlYW47IGVycm9yPzogc3RyaW5nIH0+IHtcclxuICAgICAgICBjb25zdCB2aWRlb0lkID0gdGhpcy5leHRyYWN0VmlkZW9JZCh1cmwpO1xyXG4gICAgICAgIGlmICghdmlkZW9JZCkge1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWxpZDogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBZb3VUdWJlIFVSTCBmb3JtYXQnIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmdldE1ldGFkYXRhKHVybCk7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XHJcbiAgICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbGlkOiBmYWxzZSwgZXJyb3I6ICdDb3VsZCBub3QgYWNjZXNzIHZpZGVvLiBJdCBtYXkgYmUgcHJpdmF0ZSBvciB1bmF2YWlsYWJsZS4nIH07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgZGlyZWN0IFlvdVR1YmUgVVJMIGZvciBHZW1pbmkncyBuYXRpdmUgdmlkZW8gdW5kZXJzdGFuZGluZy5cclxuICAgICAqIEdlbWluaSAxLjUgUHJvIGNhbiBhbmFseXplIFlvdVR1YmUgdmlkZW9zIGRpcmVjdGx5IHZpYSBVUkwg4oCUIG5vIGRvd25sb2FkIG5lZWRlZC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGdldFZpZGVvVXJsKHVybDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICBjb25zdCB2aWRlb0lkID0gdGhpcy5leHRyYWN0VmlkZW9JZCh1cmwpO1xyXG4gICAgICAgIGlmICghdmlkZW9JZCkgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIFlvdVR1YmUgVVJMJyk7XHJcbiAgICAgICAgcmV0dXJuIGBodHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PSR7dmlkZW9JZH1gO1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJheGlvcyIsIllvdVR1YmVTZXJ2aWNlIiwiZXh0cmFjdFZpZGVvSWQiLCJ1cmwiLCJwYXR0ZXJucyIsInBhdHRlcm4iLCJtYXRjaCIsImdldE1ldGFkYXRhIiwidmlkZW9JZCIsIkVycm9yIiwib2VtYmVkVXJsIiwicmVzcG9uc2UiLCJnZXQiLCJ0aXRsZSIsImRhdGEiLCJkdXJhdGlvbiIsInRodW1ibmFpbFVybCIsImNoYW5uZWxOYW1lIiwiYXV0aG9yX25hbWUiLCJkZXNjcmlwdGlvbiIsInZhbGlkYXRlIiwidmFsaWQiLCJlcnJvciIsImdldFZpZGVvVXJsIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/services/sources/youtube.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/next","vendor-chunks/tslib","vendor-chunks/iceberg-js","vendor-chunks/set-cookie-parser","vendor-chunks/jose","vendor-chunks/axios","vendor-chunks/asynckit","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/call-bind-apply-helpers","vendor-chunks/debug","vendor-chunks/get-proto","vendor-chunks/mime-db","vendor-chunks/has-symbols","vendor-chunks/gopd","vendor-chunks/function-bind","vendor-chunks/form-data","vendor-chunks/follow-redirects","vendor-chunks/supports-color","vendor-chunks/proxy-from-env","vendor-chunks/ms","vendor-chunks/mime-types","vendor-chunks/hasown","vendor-chunks/has-tostringtag","vendor-chunks/has-flag","vendor-chunks/get-intrinsic","vendor-chunks/es-set-tostringtag","vendor-chunks/es-object-atoms","vendor-chunks/es-define-property","vendor-chunks/dunder-proto","vendor-chunks/delayed-stream","vendor-chunks/combined-stream"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsources%2Fanalyze%2Froute&page=%2Fapi%2Fsources%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsources%2Fanalyze%2Froute.ts&appDir=K%3A%5CLearning_Production_Engine%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=K%3A%5CLearning_Production_Engine&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();